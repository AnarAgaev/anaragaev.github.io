const widgetClassName="ASWidget",widgetRoot=window.analogueService.root,fetchWidgetData=async e=>{try{const t=await fetch(e);if(!t.ok)throw new Error("Ошибка получения данных виджета");const a=await t.json();return a}catch(e){console.log("Произошла ошибка обработки данных виджета:",e)}},setWidgetStyles=e=>{const t=document.createElement("style"),a=`\n        .${widgetClassName}__wrapper {\n            --font-family: ${e["font-family"]};\n            --display-title: ${e["display-title"]};\n            --color-title: ${e["color-title"]};\n            --display-link-all: ${e["display-link-all"]};\n            --color-link-all: ${e["color-link-all"]};\n            --color-link-all-hover: ${e["color-link-all-hover"]};\n            --cards-count-sm: repeat(${e["cards-count-sm"]}, 1fr);\n            --cards-count-md: repeat(${e["cards-count-md"]}, 1fr);\n            --cards-count-lg: repeat(${e["cards-count-lg"]}, 1fr);\n            --cards-count-xl: repeat(${e["cards-count-xl"]}, 1fr);\n            --color-code: ${e["color-code"]};\n            --color-name: ${e["color-name"]};\n            --color-price: ${e["color-price"]};\n            --color-button: ${e["color-button"]};\n            --color-button-hover: ${e["color-button-hover"]};\n            --color-button-text: ${e["color-button-text"]};\n            --color-button-text-hover: ${e["color-button-text-hover"]};\n        }\n    `;t.innerHTML=a.replace(/\s/g,""),widgetRoot.appendChild(t)},setWidgetProducts=(e,t)=>{for(const a of t){if(!a.active)continue;const t=`\n            <div class="${widgetClassName}__card">\n                <div class="${widgetClassName}__card-img">\n                    <img src="${a.image}" alt="${a.name}">\n                </div>\n                <span class="${widgetClassName}__card-code">\n                    Артикул товара ${a.code}\n                </span>\n                <p class="${widgetClassName}__card-name">\n                    ${a.name}\n                </p>\n                <span class="${widgetClassName}__card-price">\n                    ${a.price}\n                </span>\n                <a href="${a.link}" class="${widgetClassName}__card-link" target="_blank">\n                    Смотреть товар\n                </a>\n            </div>\n        `,n=document.createElement("li");n.className=`${widgetClassName}__card-item`,n.innerHTML=t,e.appendChild(n)}},setWidgetTitle=(e,t)=>{if(!t)return;const a=document.createElement("h2");a.className=`${widgetClassName}__header-title`,a.innerText=t,e.appendChild(a)},setWidtetLinkAll=(e,t)=>{if(!t)return;const a=document.createElement("a");a.className=`${widgetClassName}__header-link`,a.href=t,a.textContent="Смотреть все",a.target="_blank",e.appendChild(a)},buildWidget=e=>{const t=document.createElement("div"),a=document.createElement("div"),n=document.createElement("ul");t.className=`${widgetClassName}__wrapper`,a.className=`${widgetClassName}__header`,n.className=`${widgetClassName}__card-list`,(e.title||e.all)&&(t.appendChild(a),setWidgetTitle(a,e.title),setWidtetLinkAll(a,e.all)),e.products.length>0&&(t.appendChild(n),setWidgetProducts(n,e.products)),widgetRoot.appendChild(t)};widgetRoot&&fetchWidgetData("data.json").then(e=>{widgetRoot.classList.add(widgetClassName),setWidgetStyles(e.settings),buildWidget(e)});