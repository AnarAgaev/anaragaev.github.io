import{u as p,r as c,j as e,B as j,l as M}from"./index.js";const w="_picker_1hirq_1",N="_pickerMessage_1hirq_16",B="_pickerErrorMessage_1hirq_31",C="_pickerLoading_1hirq_35",S="_pickerButton_1hirq_66",L={picker:w,pickerMessage:N,pickerErrorMessage:B,pickerLoading:C,pickerButton:S},T="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20100%20100'%20preserveAspectRatio='xMidYMid'%20width='40'%20height='40'%20style='shape-rendering:%20auto;%20display:%20block;%20background:%20rgb(255,%20255,%20255);'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cg%3e%3ccircle%20cx='84'%20cy='50'%20r='10'%20fill='%23aaaaaa'%3e%3canimate%20attributeName='r'%20repeatCount='indefinite'%20dur='0.5s'%20calcMode='spline'%20keyTimes='0;1'%20values='10;0'%20keySplines='0%200.5%200.5%201'%20begin='0s'%3e%3c/animate%3e%3canimate%20attributeName='fill'%20repeatCount='indefinite'%20dur='2s'%20calcMode='discrete'%20keyTimes='0;0.25;0.5;0.75;1'%20values='%23aaaaaa;%23aaaaaa;%23aaaaaa;%23aaaaaa;%23aaaaaa'%20begin='0s'%3e%3c/animate%3e%3c/circle%3e%3ccircle%20cx='16'%20cy='50'%20r='10'%20fill='%23aaaaaa'%3e%3canimate%20attributeName='r'%20repeatCount='indefinite'%20dur='2s'%20calcMode='spline'%20keyTimes='0;0.25;0.5;0.75;1'%20values='0;0;10;10;10'%20keySplines='0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201'%20begin='0s'%3e%3c/animate%3e%3canimate%20attributeName='cx'%20repeatCount='indefinite'%20dur='2s'%20calcMode='spline'%20keyTimes='0;0.25;0.5;0.75;1'%20values='16;16;16;50;84'%20keySplines='0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201'%20begin='0s'%3e%3c/animate%3e%3c/circle%3e%3ccircle%20cx='50'%20cy='50'%20r='10'%20fill='%23aaaaaa'%3e%3canimate%20attributeName='r'%20repeatCount='indefinite'%20dur='2s'%20calcMode='spline'%20keyTimes='0;0.25;0.5;0.75;1'%20values='0;0;10;10;10'%20keySplines='0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201'%20begin='-0.5s'%3e%3c/animate%3e%3canimate%20attributeName='cx'%20repeatCount='indefinite'%20dur='2s'%20calcMode='spline'%20keyTimes='0;0.25;0.5;0.75;1'%20values='16;16;16;50;84'%20keySplines='0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201'%20begin='-0.5s'%3e%3c/animate%3e%3c/circle%3e%3ccircle%20cx='84'%20cy='50'%20r='10'%20fill='%23aaaaaa'%3e%3canimate%20attributeName='r'%20repeatCount='indefinite'%20dur='2s'%20calcMode='spline'%20keyTimes='0;0.25;0.5;0.75;1'%20values='0;0;10;10;10'%20keySplines='0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201'%20begin='-1s'%3e%3c/animate%3e%3canimate%20attributeName='cx'%20repeatCount='indefinite'%20dur='2s'%20calcMode='spline'%20keyTimes='0;0.25;0.5;0.75;1'%20values='16;16;16;50;84'%20keySplines='0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201'%20begin='-1s'%3e%3c/animate%3e%3c/circle%3e%3ccircle%20cx='16'%20cy='50'%20r='10'%20fill='%23aaaaaa'%3e%3canimate%20attributeName='r'%20repeatCount='indefinite'%20dur='2s'%20calcMode='spline'%20keyTimes='0;0.25;0.5;0.75;1'%20values='0;0;10;10;10'%20keySplines='0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201'%20begin='-1.5s'%3e%3c/animate%3e%3canimate%20attributeName='cx'%20repeatCount='indefinite'%20dur='2s'%20calcMode='spline'%20keyTimes='0;0.25;0.5;0.75;1'%20values='16;16;16;50;84'%20keySplines='0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201;0%200.5%200.5%201'%20begin='-1.5s'%3e%3c/animate%3e%3c/circle%3e%3cg%3e%3c/g%3e%3c/g%3e%3c/svg%3e",E={delimiter:{error:`
`},path:{enabled:!0,type:"zodPathArray",label:"Zod Path: "},code:{enabled:!0},message:{enabled:!0,label:""},transform:({errorMessage:s,index:a})=>`🔥 \x1B[31m Zod Error #${a+1}: \x1B[33m ${s}`},{picker:z,pickerMessage:P,pickerButton:q,pickerErrorMessage:I,pickerLoading:R}=L,W=()=>{const s=p(d=>d.addUploadedBackground),[a,i]=c.useState(null),[n,u]=c.useState(null),o=c.useRef(null),l=["image/jpeg","image/jpg","image/png","image/gif","image/webp"],r=async d=>{if(!d.target.files)return;const k=d.target.files[0];if(l.findIndex(t=>t===k.type)===-1){i(void 0);return}else i(null);u(k);try{const t=window.uploadBackgroundLink,_=window.userToken;t||console.error("На странице не указана ссылка на Загрузку картинки для фона window.uploadBackgroundLink");const b={};_&&(b.Token=_);const g=new FormData;g.append("domain","fandeco"),g.append("image",d.target.files[0]),g.append("dir","backgrounds");const f=await fetch(t,{method:"POST",headers:b,body:g});f.ok||console.error("Failed to upload background image to",t);const h=await f.json();console.log(h);const m=j.passthrough().safeParse(h);if(console.log("Uploading image response",m),!m.success){const $=M.generateErrorMessage(m.error.issues,E);console.log($);return}s(m.data)}catch(t){console.error(t),i(void 0)}finally{u(null)}},y=(()=>{if(a===void 0)return e.jsx("span",{className:I,children:"Ошибка загрузки файла"});if(a===null&&n===null)return"Загрузите свой фон";if(a===null&&n)return e.jsxs("span",{className:R,children:[e.jsx("b",{children:"Загружаем файл:"}),e.jsx("mark",{children:n.name.split(".")[0]+"."}),e.jsx("span",{children:n.name.split(".")[1]}),e.jsx("img",{src:T,alt:""})]})})(),v=a===null&&n?"button button_block button_lite disabled":"button button_block button_lite";return e.jsxs("div",{className:z,children:[e.jsx("input",{className:"invisible",type:"file",ref:o,onChange:r,capture:"user",accept:"image/*, image/jpeg, image/jpg, image/png, image/gif, image/webp"}),e.jsx("span",{className:P,children:y}),e.jsx("div",{className:q,children:e.jsx("button",{type:"button",className:v,onClick:()=>o.current&&o.current.click(),children:"Выбрать файл"})})]})},A="_backgroundList_1eu4o_14",F="_caption_1eu4o_20",U="_list_1eu4o_33",O="_item_1eu4o_41",Z="_shine_1eu4o_1",D="_item_active_1eu4o_78",Y={backgroundList:A,caption:F,list:U,item:O,shine:Z,item_active:D,"image-failed":"_image-failed_1eu4o_1"},{backgroundList:G,caption:H,list:J,item:x,item_active:K}=Y,Q=(s,a)=>s.map(i=>{const n=i.selected?`${x} ${K}`:`${x}`;return e.jsx("li",{className:`${n}`,children:e.jsx(re,{source:i.preview,id:i.id,active:i.selected})},`${a}-${i.id}`)}),V=()=>{const s=p(n=>n.backgrounds),a=c.useId(),i=c.useMemo(()=>Q(s,a),[s,a]);return e.jsxs("div",{className:G,children:[e.jsx("h2",{className:H,children:"Выберите фон:"}),e.jsx("ul",{className:J,children:i})]})},X="_image_nah1n_14",ee="_image_active_nah1n_25",ae="_image_loaded_nah1n_28",ie="_shine_nah1n_1",se={image:X,image_active:ee,image_loaded:ae,"image-failed":"_image-failed_nah1n_1",shine:ie},{image:ne,image_active:te,image_loaded:ce}=se,re=({source:s,id:a,active:i})=>{const n=p(r=>r.setActiveBackground),[u,o]=c.useState(!1);c.useEffect(()=>{const r=new Image;r.src=s,r.onload=()=>o(!0)},[]);let l=ne;return i&&(l+=` ${te}`),u&&(l+=` ${ce}`),e.jsx("img",{className:l,src:`${s}`,alt:"",loading:"lazy",onClick:()=>n(a)})},oe="_backgroundsWorkspace_1fnhl_1",le={backgroundsWorkspace:oe},ue=()=>e.jsxs("div",{className:le.backgroundsWorkspace,children:[e.jsx(W,{}),e.jsx(V,{})]});export{ue as default};
