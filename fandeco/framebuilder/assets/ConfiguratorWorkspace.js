import{r as E,u as et,j as p,O as he}from"./index.js";import{c as ve}from"./collapseDevices.js";import{I as He}from"./InputAdd.js";const Ge=(t,e)=>{const o=t.width/t.height,i=e.width/e.height;let c=0,s=0,n=0,a=0;return o<i?(a=t.height,n=a*i,c=(t.width-n)/2):(n=t.width,a=n/i,s=(t.height-a)/2),[c,s,n,a]},We="_sketch_1sjpg_14",Ue="_construction_1sjpg_29",Ke="_posts_1sjpg_48",Xe="_postActive_1sjpg_83",Qe="_directions_1sjpg_100",Ye="_directionActive_1sjpg_148",Je="_horizontal_1sjpg_167",Ze="_vertical_1sjpg_171",tn="_save_1sjpg_175",en="_controllers_1sjpg_193",nn="_disabled_1sjpg_223",sn="_trash_1sjpg_232",on="_minus_1sjpg_236",cn="_plus_1sjpg_240",rn="_set_1sjpg_244",an="_wrap_1sjpg_256",ln="_placeholder_1sjpg_267",un="_changeBorderColor_1sjpg_1",dn="_container_1sjpg_303",fn="_containerVertical_1sjpg_317",pn="_imageVertical_1sjpg_332",mn="_post_1_1sjpg_352",_n="_post_2_1sjpg_357",gn="_post_3_1sjpg_362",hn="_post_4_1sjpg_367",vn="_post_5_1sjpg_372",xn="_img_1_1sjpg_377",$n="_img_2_1sjpg_382",jn="_img_3_1sjpg_387",bn="_img_4_1sjpg_392",yn="_img_5_1sjpg_397",Sn="_borderImg_1sjpg_402",kn="_deviceContainer_1sjpg_413",Cn="_loader_1sjpg_423",Nn="_shine_1sjpg_1",In={sketch:We,construction:Ue,posts:Ke,postActive:Xe,directions:Qe,directionActive:Ye,horizontal:Je,vertical:Ze,save:tn,controllers:en,disabled:nn,trash:sn,minus:on,plus:cn,set:rn,wrap:an,placeholder:ln,changeBorderColor:un,container:dn,containerVertical:fn,imageVertical:pn,post_1:mn,post_2:_n,post_3:gn,post_4:hn,post_5:vn,img_1:xn,img_2:$n,img_3:jn,img_4:bn,img_5:yn,borderImg:Sn,deviceContainer:kn,loader:Cn,"image-failed":"_image-failed_1sjpg_1",shine:Nn},{sketch:Ln,construction:Dn,posts:Wt,directions:Ut,horizontal:En,vertical:wn,save:On,controllers:Kt,trash:Tn,minus:Xt,plus:Qt,disabled:ot,set:Pn,wrap:Bn,placeholder:Mn,container:Fn,postActive:xe,directionActive:Yt,loader:An,containerVertical:zn,imageVertical:Vn,borderImg:Rn,post_1:Nt,post_2:qn,post_3:Hn,post_4:Gn,post_5:Wn,img_1:Jt,img_2:Un,img_3:Kn,img_4:Xn,img_5:Qn}=In,Yn=(t,e,o,i,c,s,n)=>{const a=[],r={1:"пост",2:"поста",3:"поста",4:"поста",5:"постов"},f=s?Array.from(new Set(n(s).flatMap(_=>_.number_of_posts))):[];for(let _=1;_<=(s?e:5);_++){const l=o.length?p.jsx("li",{className:o[_-1]?xe:"",children:p.jsx("span",{onClick:d=>i(d,_,c),title:`Выбрать рамку на ${_} ${r[_]}`,children:_})},`post-${t}-${_}`):p.jsx("li",{children:p.jsx("span",{children:_})},`post-${t}-${_}`);s?f.includes(_.toString())&&a.push(l):a.push(l)}return a},Jn=()=>{const t=E.useId(),[e,o,i,c,s,n,a,r,f,_,l,d,h,u,v,g,m,x,$,S,I]=et(C=>[C.scale,C.postsCount,C.resizeSketch,C.selectedPost,C.border,C.setBorder,C.getSiblingBorder,C.fireError,C.resetSketch,C.deviceList,C.checkDevices,C.direction,C.visible,C.resetProject,C.resetRoom,C.resetCountOfSets,C.removeSingleBordersFilter,C.removeSingleDevicesFilter,C.resetEditConfiguration,C.resetBackground,C.getFamilyBorders]),k=E.useRef(null),y=E.useRef(null),j=E.useRef(null),N=E.useRef(null),L=E.useRef(null),D=E.useRef(null),P=l(),z={transform:`scale(${e})`,transformOrigin:`${e>1?"0 0":"center"}`},G=()=>{e>=1.5||i(1)},W=()=>{e<=.5||i(-1)},J=E.useCallback(C=>{var A;if((A=D.current)!=null&&A.classList.contains(ot)||d===C)return;let B=c.findIndex(Boolean);if(B=B===-1?1:B+1,s){const O=a(s,B,C);n(O,B,o,C)}},[d,s,c,o,a,n]),U=E.useCallback((C,B,A)=>{var w;if(!((w=L.current)!=null&&w.classList.contains(ot)||C.target.parentNode.classList.contains(xe))&&s){const M=a(s,B,A);if(console.log("newBorder",M),!M){r(new Error(`Функция поиска соседних рамок [getSiblingBorder] с количеством постов ${B} вернула пустой результат!`));return}(B===1||B===2||B===3||B===4||B===5)&&n(M,B)}},[s,n,a,r]),K=E.useMemo(()=>Yn(t,o,c,U,d,s,I),[t,o,c,U,d,s,I]),X=()=>{f(),u(),v(),g(),m("brand"),m("collection"),x("brand"),x("collection"),$(),S()},ct={0:"",1:Jt,2:Un,3:Kn,4:Xn,5:Qn},q={0:"",1:Nt,2:qn,3:Hn,4:Gn,5:Wn},H=c.findIndex(Boolean)+1,nt=d==="horizontal"?H===0?Nt:q[H]:(s==null?void 0:s.conf_orientation)==="vertical"?H===0?Jt:ct[H]:H===0?Nt:q[H],Q=d==="horizontal"?"":(s==null?void 0:s.conf_orientation)==="vertical"?` ${Vn}`:` ${zn}`,it=`${Fn} ${nt} ${Q}`,V=`translate(-50%, -50%) rotate(${d==="horizontal"||(s==null?void 0:s.conf_orientation)==="vertical"?"0":"90deg"})`;return p.jsxs("div",{id:"step_5",ref:k,className:Ln,children:[p.jsx(ns,{backImgRef:y}),p.jsx("span",{className:An,style:{opacity:h?0:1}}),p.jsxs("div",{className:Dn,children:[p.jsx("ul",{ref:L,className:c.length?Wt:`${Wt} ${ot}`,children:K}),p.jsxs("ul",{ref:D,className:c.length>2&&!c[0]?Ut:`${Ut} ${ot}`,children:[p.jsx("li",{title:"Выбрать горизонтальное направление",onClick:()=>J("horizontal"),className:d==="horizontal"&&c.length>2&&!c[0]?Yt:"",children:p.jsx("i",{className:En})}),p.jsx("li",{title:"Выбрать вертикальное направление",onClick:()=>J("vertical"),className:d==="vertical"&&c.length>2&&!c[0]?Yt:"",children:p.jsx("i",{className:wn})})]})]}),p.jsx("div",{className:`${On} ${s?"":ot}`,title:"Сохранить эскиз",children:p.jsx(ri,{sketchRef:k,backImgRef:y,borderRef:j,listRef:N})}),p.jsxs("ul",{className:c.length||Object.keys(_).length?Kt:`${Kt} ${ot}`,children:[p.jsx("li",{className:Tn,onClick:X,title:"Очистить эскиз"}),p.jsx("li",{className:e<=.5?`${Xt} ${ot}`:Xt,onClick:W,title:"Уменьшить масштаб"}),p.jsx("li",{className:e>=1.5?`${Qt} ${ot}`:Qt,onClick:G,title:"Увеличить масштаб"})]}),p.jsx("div",{className:Pn,children:p.jsxs("div",{className:Bn,style:z,children:[!s&&h&&p.jsx("span",{className:Mn}),p.jsxs("div",{className:it,style:{opacity:h?"1":"0",transform:V},children:[s&&p.jsx("img",{className:Rn,ref:j,src:s.image,alt:s.name}),P&&p.jsx(ni,{listRef:N})]})]})})]})},Zn="_sketchBackground_1q5to_14",ts="_shine_1q5to_1",es={sketchBackground:Zn,"image-failed":"_image-failed_1q5to_1",shine:ts},ns=({backImgRef:t})=>{const o=et(i=>i.backgrounds).filter(i=>i.selected);return p.jsx("span",{className:es.sketchBackground,children:o.length>0&&p.jsx("img",{ref:t,src:o[0].image,alt:""})})},ss="_cart_2unc7_14",os="_section_2unc7_23",cs="_caption_2unc7_29",is="_shine_2unc7_1",rs={cart:ss,section:os,caption:cs,"image-failed":"_image-failed_2unc7_1",shine:is},{cart:as,section:Zt,caption:te}=rs,ls=()=>{const[t,e,o,i,c,s,n,a,r,f,_,l,d,h,u]=et(j=>[j.border,j.checkDevices,j.modalMessageSet,j.checkProject,j.checkRoom,j.projects,j.rooms,j.addConfiguration,j.getSelectedBackgroundId,j.deviceList,j.countOfSets,j.editConfiguration,j.direction,j.saveConfiguration,j.addProductsToCart]),v=!!t,g=e(),m=i(),x=c(),$=()=>{if(!v&&!g){o(!0,"Необходимо выбрать рамку или хотя бы одно устройство");return}if(!m){o(!0,`Необходимо ${s.length?"выбрать":"добавить"} проект`);return}if(!x){o(!0,`Необходимо ${n.length?"выбрать":"добавить"} помещение`);return}const j=[...s].filter(P=>P.selected)[0],N=[...n].filter(P=>P.selected)[0],L=r(),D=Object.values(f);a(j.id,N.id,N.name,L,t,D,_,d)},S=()=>{if(!g&&!v){o(!0,"Необходимо выбрать хотя бы одно устройство или рамку");return}const j=r(),N=Object.values(f);h(j,t,N,d)},I=()=>{const j=ve(Object.values(f)),N=[];t&&N.push({type:"border",article:t.article,count:_}),j.forEach(L=>{L&&N.push({type:"device",article:L.article,count:L.selectedCount*_})}),u(N)},k=`button button_block button_dark ${!v&&!g||!m||!x?"clickedDisabled":""}`,y=`button button_block button_dark ${!v&&!g?"clickedDisabled":""}`;return p.jsxs("div",{className:as,children:[p.jsxs("div",{id:"step_6",className:Zt,children:[p.jsx("h3",{className:te,children:"Стоимость полного комплекта"}),p.jsx(Ls,{}),p.jsx(Zo,{}),l?p.jsx("button",{type:"button",onClick:S,className:y,children:"Сохранить комплект"}):p.jsx("button",{type:"button",onClick:$,className:k,children:"Добавить в проект"})]}),(v||g)&&p.jsxs("div",{id:"step_7",className:Zt,children:[p.jsx("h3",{className:te,children:"Состав комплекта"}),p.jsx(Vo,{}),p.jsx("button",{type:"button",onClick:I,className:"button button_block button_dark",children:"Добавить комплект в корзину"})]})]})},us="_wrap_a5p7g_14",ds="_price_a5p7g_25",fs="_priceDisabled_a5p7g_36",ps="_counter_a5p7g_41",ms="_counterDisabled_a5p7g_47",_s="_controller_a5p7g_58",gs="_controller_dec_a5p7g_98",hs="_controller_inc_a5p7g_101",vs="_val_a5p7g_105",xs="_shine_a5p7g_1",$s={wrap:us,price:ds,priceDisabled:fs,counter:ps,counterDisabled:ms,controller:_s,controller_dec:gs,controller_inc:hs,val:vs,"image-failed":"_image-failed_a5p7g_1",shine:xs},{wrap:js,price:bs,priceDisabled:ys,counter:Ss,counterDisabled:ks,val:Cs,controller:ee,controller_dec:Ns,controller_inc:Is}=$s,Ls=()=>{const[t,e,o,i,c]=et(r=>[r.countOfSets,r.setCountOfSets,r.border,r.deviceList,r.checkDevices]),s=E.useMemo(()=>{let r=0;const f=_=>typeof _.price=="string"?parseFloat(_.price):_.price;o&&(r+=f(o));for(const _ in i){const l=parseInt(_);if(l===1||l===2||l===3||l===4||l===5){if(i[l]===null)continue;const d=i[l];d&&(r+=f(d))}}return(Math.round(r*t*100)/100).toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")},[o,i,t]),n=r=>{e(r)},a=c();return p.jsxs("div",{className:js,children:[p.jsxs("span",{className:`${bs} ${parseInt(s)===0?ys:""}`,children:[s," ₽"]}),p.jsxs("div",{className:`${Ss} ${!o&&!a?ks:""}`,children:[p.jsx("button",{type:"button",onClick:()=>n(-1),className:`${ee} ${Ns}`}),p.jsx("input",{readOnly:!0,type:"text",className:Cs,value:parseInt(s)===0?0:t}),p.jsx("button",{type:"button",onClick:()=>n(1),className:`${ee} ${Is}`})]})]})};function Ds(t){return Object.prototype.toString.call(t)==="[object Object]"}function ne(t){return Ds(t)||Array.isArray(t)}function Es(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function Ot(t,e){const o=Object.keys(t),i=Object.keys(e);if(o.length!==i.length)return!1;const c=JSON.stringify(Object.keys(t.breakpoints||{})),s=JSON.stringify(Object.keys(e.breakpoints||{}));return c!==s?!1:o.every(n=>{const a=t[n],r=e[n];return typeof a=="function"?`${a}`==`${r}`:!ne(a)||!ne(r)?a===r:Ot(a,r)})}function se(t){return t.concat().sort((e,o)=>e.name>o.name?1:-1).map(e=>e.options)}function ws(t,e){if(t.length!==e.length)return!1;const o=se(t),i=se(e);return o.every((c,s)=>{const n=i[s];return Ot(c,n)})}function Tt(t){return typeof t=="number"}function Et(t){return typeof t=="string"}function jt(t){return typeof t=="boolean"}function oe(t){return Object.prototype.toString.call(t)==="[object Object]"}function F(t){return Math.abs(t)}function Pt(t){return Math.sign(t)}function mt(t,e){return F(t-e)}function Os(t,e){if(t===0||e===0||F(t)<=F(e))return 0;const o=mt(F(t),F(e));return F(o/t)}function Ts(t){return Math.round(t*100)/100}function _t(t){return gt(t).map(Number)}function Y(t){return t[vt(t)]}function vt(t){return Math.max(0,t.length-1)}function Bt(t,e){return e===vt(t)}function ce(t,e=0){return Array.from(Array(t),(o,i)=>e+i)}function gt(t){return Object.keys(t)}function $e(t,e){return[t,e].reduce((o,i)=>(gt(i).forEach(c=>{const s=o[c],n=i[c],a=oe(s)&&oe(n);o[c]=a?$e(s,n):n}),o),{})}function wt(t,e){return typeof e.MouseEvent<"u"&&t instanceof e.MouseEvent}function Ps(t,e){const o={start:i,center:c,end:s};function i(){return 0}function c(r){return s(r)/2}function s(r){return e-r}function n(r,f){return Et(t)?o[t](r):t(e,r,f)}return{measure:n}}function ht(){let t=[];function e(c,s,n,a={passive:!0}){let r;if("addEventListener"in c)c.addEventListener(s,n,a),r=()=>c.removeEventListener(s,n,a);else{const f=c;f.addListener(n),r=()=>f.removeListener(n)}return t.push(r),i}function o(){t=t.filter(c=>c())}const i={add:e,clear:o};return i}function Bs(t,e,o,i){const c=ht(),s=1e3/60;let n=null,a=0,r=0;function f(){c.add(t,"visibilitychange",()=>{t.hidden&&u()})}function _(){h(),c.clear()}function l(g){if(!r)return;n||(n=g);const m=g-n;for(n=g,a+=m;a>=s;)o(),a-=s;const x=a/s;i(x),r&&(r=e.requestAnimationFrame(l))}function d(){r||(r=e.requestAnimationFrame(l))}function h(){e.cancelAnimationFrame(r),n=null,a=0,r=0}function u(){n=null,a=0}return{init:f,destroy:_,start:d,stop:h,update:o,render:i}}function Ms(t,e){const o=e==="rtl",i=t==="y",c=i?"y":"x",s=i?"x":"y",n=!i&&o?-1:1,a=_(),r=l();function f(u){const{height:v,width:g}=u;return i?v:g}function _(){return i?"top":o?"right":"left"}function l(){return i?"bottom":o?"left":"right"}function d(u){return u*n}return{scroll:c,cross:s,startEdge:a,endEdge:r,measureSize:f,direction:d}}function lt(t=0,e=0){const o=F(t-e);function i(f){return f<t}function c(f){return f>e}function s(f){return i(f)||c(f)}function n(f){return s(f)?i(f)?t:e:f}function a(f){return o?f-o*Math.ceil((f-e)/o):f}return{length:o,max:e,min:t,constrain:n,reachedAny:s,reachedMax:c,reachedMin:i,removeOffset:a}}function je(t,e,o){const{constrain:i}=lt(0,t),c=t+1;let s=n(e);function n(d){return o?F((c+d)%c):i(d)}function a(){return s}function r(d){return s=n(d),l}function f(d){return _().set(a()+d)}function _(){return je(t,a(),o)}const l={get:a,set:r,add:f,clone:_};return l}function Fs(t,e,o,i,c,s,n,a,r,f,_,l,d,h,u,v,g,m,x){const{cross:$,direction:S}=t,I=["INPUT","SELECT","TEXTAREA"],k={passive:!1},y=ht(),j=ht(),N=lt(50,225).constrain(h.measure(20)),L={mouse:300,touch:400},D={mouse:500,touch:600},P=u?43:25;let z=!1,G=0,W=0,J=!1,U=!1,K=!1,X=!1;function ct(b){if(!x)return;function w(R){(jt(x)||x(b,R))&&ut(R)}const M=e;y.add(M,"dragstart",R=>R.preventDefault(),k).add(M,"touchmove",()=>{},k).add(M,"touchend",()=>{}).add(M,"touchstart",w).add(M,"mousedown",w).add(M,"touchcancel",C).add(M,"contextmenu",C).add(M,"click",B,!0)}function q(){y.clear(),j.clear()}function H(){const b=X?o:e;j.add(b,"touchmove",V,k).add(b,"touchend",C).add(b,"mousemove",V,k).add(b,"mouseup",C)}function nt(b){const w=b.nodeName||"";return I.includes(w)}function Q(){return(u?D:L)[X?"mouse":"touch"]}function it(b,w){const M=l.add(Pt(b)*-1),R=_.byDistance(b,!u).distance;return u||F(b)<N?R:g&&w?R*.5:_.byIndex(M.get(),0).distance}function ut(b){const w=wt(b,i);X=w,K=u&&w&&!b.buttons&&z,z=mt(c.get(),n.get())>=2,!(w&&b.button!==0)&&(nt(b.target)||(J=!0,s.pointerDown(b),f.useFriction(0).useDuration(0),c.set(n),H(),G=s.readPoint(b),W=s.readPoint(b,$),d.emit("pointerDown")))}function V(b){if(!wt(b,i)&&b.touches.length>=2)return C(b);const M=s.readPoint(b),R=s.readPoint(b,$),Z=mt(M,G),tt=mt(R,W);if(!U&&!X&&(!b.cancelable||(U=Z>tt,!U)))return C(b);const rt=s.pointerMove(b);Z>v&&(K=!0),f.useFriction(.3).useDuration(.75),a.start(),c.add(S(rt)),b.preventDefault()}function C(b){const M=_.byDistance(0,!1).index!==l.get(),R=s.pointerUp(b)*Q(),Z=it(S(R),M),tt=Os(R,Z),rt=P-10*tt,st=m+tt/50;U=!1,J=!1,j.clear(),f.useDuration(rt).useFriction(st),r.distance(Z,!u),X=!1,d.emit("pointerUp")}function B(b){K&&(b.stopPropagation(),b.preventDefault(),K=!1)}function A(){return J}return{init:ct,destroy:q,pointerDown:A}}function As(t,e){let i,c;function s(l){return l.timeStamp}function n(l,d){const u=`client${(d||t.scroll)==="x"?"X":"Y"}`;return(wt(l,e)?l:l.touches[0])[u]}function a(l){return i=l,c=l,n(l)}function r(l){const d=n(l)-n(c),h=s(l)-s(i)>170;return c=l,h&&(i=l),d}function f(l){if(!i||!c)return 0;const d=n(c)-n(i),h=s(l)-s(i),u=s(l)-s(c)>170,v=d/h;return h&&!u&&F(v)>.1?v:0}return{pointerDown:a,pointerMove:r,pointerUp:f,readPoint:n}}function zs(){function t(o){const{offsetTop:i,offsetLeft:c,offsetWidth:s,offsetHeight:n}=o;return{top:i,right:c+s,bottom:i+n,left:c,width:s,height:n}}return{measure:t}}function Vs(t){function e(i){return t*(i/100)}return{measure:e}}function Rs(t,e,o,i,c,s,n){const a=[t].concat(i);let r,f,_=[],l=!1;function d(g){return c.measureSize(n.measure(g))}function h(g){if(!s)return;f=d(t),_=i.map(d);function m(x){for(const $ of x){if(l)return;const S=$.target===t,I=i.indexOf($.target),k=S?f:_[I],y=d(S?t:i[I]);if(F(y-k)>=.5){g.reInit(),e.emit("resize");break}}}r=new ResizeObserver(x=>{(jt(s)||s(g,x))&&m(x)}),o.requestAnimationFrame(()=>{a.forEach(x=>r.observe(x))})}function u(){l=!0,r&&r.disconnect()}return{init:h,destroy:u}}function qs(t,e,o,i,c,s){let n=0,a=0,r=c,f=s,_=t.get(),l=0;function d(){const k=i.get()-t.get(),y=!r;let j=0;return y?(n=0,o.set(i),t.set(i),j=k):(o.set(t),n+=k/r,n*=f,_+=n,t.add(n),j=_-l),a=Pt(j),l=_,I}function h(){const k=i.get()-e.get();return F(k)<.001}function u(){return r}function v(){return a}function g(){return n}function m(){return $(c)}function x(){return S(s)}function $(k){return r=k,I}function S(k){return f=k,I}const I={direction:v,duration:u,velocity:g,seek:d,settled:h,useBaseFriction:x,useBaseDuration:m,useFriction:S,useDuration:$};return I}function Hs(t,e,o,i,c){const s=c.measure(10),n=c.measure(50),a=lt(.1,.99);let r=!1;function f(){return!(r||!t.reachedAny(o.get())||!t.reachedAny(e.get()))}function _(h){if(!f())return;const u=t.reachedMin(e.get())?"min":"max",v=F(t[u]-e.get()),g=o.get()-e.get(),m=a.constrain(v/n);o.subtract(g*m),!h&&F(g)<s&&(o.set(t.constrain(o.get())),i.useDuration(25).useBaseFriction())}function l(h){r=!h}return{shouldConstrain:f,constrain:_,toggleActive:l}}function Gs(t,e,o,i,c){const s=lt(-e+t,0),n=l(),a=_(),r=d();function f(u,v){return mt(u,v)<1}function _(){const u=n[0],v=Y(n),g=n.lastIndexOf(u),m=n.indexOf(v)+1;return lt(g,m)}function l(){return o.map((u,v)=>{const{min:g,max:m}=s,x=s.constrain(u),$=!v,S=Bt(o,v);return $?m:S||f(g,x)?g:f(m,x)?m:x}).map(u=>parseFloat(u.toFixed(3)))}function d(){if(e<=t+c)return[s.max];if(i==="keepSnaps")return n;const{min:u,max:v}=a;return n.slice(u,v)}return{snapsContained:r,scrollContainLimit:a}}function Ws(t,e,o){const i=e[0],c=o?i-t:Y(e);return{limit:lt(c,i)}}function Us(t,e,o,i){const s=e.min+.1,n=e.max+.1,{reachedMin:a,reachedMax:r}=lt(s,n);function f(d){return d===1?r(o.get()):d===-1?a(o.get()):!1}function _(d){if(!f(d))return;const h=t*(d*-1);i.forEach(u=>u.add(h))}return{loop:_}}function Ks(t){const{max:e,length:o}=t;function i(s){const n=s-e;return o?n/-o:0}return{get:i}}function Xs(t,e,o,i,c){const{startEdge:s,endEdge:n}=t,{groupSlides:a}=c,r=l().map(e.measure),f=d(),_=h();function l(){return a(i).map(v=>Y(v)[n]-v[0][s]).map(F)}function d(){return i.map(v=>o[s]-v[s]).map(v=>-F(v))}function h(){return a(f).map(v=>v[0]).map((v,g)=>v+r[g])}return{snaps:f,snapsAligned:_}}function Qs(t,e,o,i,c,s){const{groupSlides:n}=c,{min:a,max:r}=i,f=_();function _(){const d=n(s),h=!t||e==="keepSnaps";return o.length===1?[s]:h?d:d.slice(a,r).map((u,v,g)=>{const m=!v,x=Bt(g,v);if(m){const $=Y(g[0])+1;return ce($)}if(x){const $=vt(s)-Y(g)[0]+1;return ce($,Y(g)[0])}return u})}return{slideRegistry:f}}function Ys(t,e,o,i,c){const{reachedAny:s,removeOffset:n,constrain:a}=i;function r(u){return u.concat().sort((v,g)=>F(v)-F(g))[0]}function f(u){const v=t?n(u):a(u),g=e.map((x,$)=>({diff:_(x-v,0),index:$})).sort((x,$)=>F(x.diff)-F($.diff)),{index:m}=g[0];return{index:m,distance:v}}function _(u,v){const g=[u,u+o,u-o];if(!t)return u;if(!v)return r(g);const m=g.filter(x=>Pt(x)===v);return m.length?r(m):Y(g)-o}function l(u,v){const g=e[u]-c.get(),m=_(g,v);return{index:u,distance:m}}function d(u,v){const g=c.get()+u,{index:m,distance:x}=f(g),$=!t&&s(g);if(!v||$)return{index:m,distance:u};const S=e[m]-x,I=u+_(S,0);return{index:m,distance:I}}return{byDistance:d,byIndex:l,shortcut:_}}function Js(t,e,o,i,c,s,n){function a(l){const d=l.distance,h=l.index!==e.get();s.add(d),d&&(i.duration()?t.start():(t.update(),t.render(1),t.update())),h&&(o.set(e.get()),e.set(l.index),n.emit("select"))}function r(l,d){const h=c.byDistance(l,d);a(h)}function f(l,d){const h=e.clone().set(l),u=c.byIndex(h.get(),d);a(u)}return{distance:r,index:f}}function Zs(t,e,o,i,c,s,n,a){const r={passive:!0,capture:!0};let f=0;function _(h){if(!a)return;function u(v){if(new Date().getTime()-f>10)return;n.emit("slideFocusStart"),t.scrollLeft=0;const x=o.findIndex($=>$.includes(v));Tt(x)&&(c.useDuration(0),i.index(x,0),n.emit("slideFocus"))}s.add(document,"keydown",l,!1),e.forEach((v,g)=>{s.add(v,"focus",m=>{(jt(a)||a(h,m))&&u(g)},r)})}function l(h){h.code==="Tab"&&(f=new Date().getTime())}return{init:_}}function pt(t){let e=t;function o(){return e}function i(r){e=n(r)}function c(r){e+=n(r)}function s(r){e-=n(r)}function n(r){return Tt(r)?r:r.get()}return{get:o,set:i,add:c,subtract:s}}function be(t,e){const o=t.scroll==="x"?n:a,i=e.style;let c=null,s=!1;function n(d){return`translate3d(${d}px,0px,0px)`}function a(d){return`translate3d(0px,${d}px,0px)`}function r(d){if(s)return;const h=Ts(t.direction(d));h!==c&&(i.transform=o(h),c=h)}function f(d){s=!d}function _(){s||(i.transform="",e.getAttribute("style")||e.removeAttribute("style"))}return{clear:_,to:r,toggleActive:f}}function to(t,e,o,i,c,s,n,a,r){const _=_t(c),l=_t(c).reverse(),d=m().concat(x());function h(y,j){return y.reduce((N,L)=>N-c[L],j)}function u(y,j){return y.reduce((N,L)=>h(N,j)>0?N.concat([L]):N,[])}function v(y){return s.map((j,N)=>({start:j-i[N]+.5+y,end:j+e-.5+y}))}function g(y,j,N){const L=v(j);return y.map(D=>{const P=N?0:-o,z=N?o:0,G=N?"end":"start",W=L[D][G];return{index:D,loopPoint:W,slideLocation:pt(-1),translate:be(t,r[D]),target:()=>a.get()>W?P:z}})}function m(){const y=n[0],j=u(l,y);return g(j,o,!1)}function x(){const y=e-n[0]-1,j=u(_,y);return g(j,-o,!0)}function $(){return d.every(({index:y})=>{const j=_.filter(N=>N!==y);return h(j,e)<=.1})}function S(){d.forEach(y=>{const{target:j,translate:N,slideLocation:L}=y,D=j();D!==L.get()&&(N.to(D),L.set(D))})}function I(){d.forEach(y=>y.translate.clear())}return{canLoop:$,clear:I,loop:S,loopPoints:d}}function eo(t,e,o){let i,c=!1;function s(r){if(!o)return;function f(_){for(const l of _)if(l.type==="childList"){r.reInit(),e.emit("slidesChanged");break}}i=new MutationObserver(_=>{c||(jt(o)||o(r,_))&&f(_)}),i.observe(t,{childList:!0})}function n(){i&&i.disconnect(),c=!0}return{init:s,destroy:n}}function no(t,e,o,i){const c={};let s=null,n=null,a,r=!1;function f(){a=new IntersectionObserver(u=>{r||(u.forEach(v=>{const g=e.indexOf(v.target);c[g]=v}),s=null,n=null,o.emit("slidesInView"))},{root:t.parentElement,threshold:i}),e.forEach(u=>a.observe(u))}function _(){a&&a.disconnect(),r=!0}function l(u){return gt(c).reduce((v,g)=>{const m=parseInt(g),{isIntersecting:x}=c[m];return(u&&x||!u&&!x)&&v.push(m),v},[])}function d(u=!0){if(u&&s)return s;if(!u&&n)return n;const v=l(u);return u&&(s=v),u||(n=v),v}return{init:f,destroy:_,get:d}}function so(t,e,o,i,c,s){const{measureSize:n,startEdge:a,endEdge:r}=t,f=o[0]&&c,_=u(),l=v(),d=o.map(n),h=g();function u(){if(!f)return 0;const x=o[0];return F(e[a]-x[a])}function v(){if(!f)return 0;const x=s.getComputedStyle(Y(i));return parseFloat(x.getPropertyValue(`margin-${r}`))}function g(){return o.map((x,$,S)=>{const I=!$,k=Bt(S,$);return I?d[$]+_:k?d[$]+l:S[$+1][a]-x[a]}).map(F)}return{slideSizes:d,slideSizesWithGaps:h,startGap:_,endGap:l}}function oo(t,e,o,i,c,s,n,a,r){const{startEdge:f,endEdge:_,direction:l}=t,d=Tt(o);function h(m,x){return _t(m).filter($=>$%x===0).map($=>m.slice($,$+x))}function u(m){return m.length?_t(m).reduce((x,$,S)=>{const I=Y(x)||0,k=I===0,y=$===vt(m),j=c[f]-s[I][f],N=c[f]-s[$][_],L=!i&&k?l(n):0,D=!i&&y?l(a):0,P=F(N-D-(j+L));return S&&P>e+r&&x.push($),y&&x.push(m.length),x},[]).map((x,$,S)=>{const I=Math.max(S[$-1]||0);return m.slice(I,x)}):[]}function v(m){return d?h(m,o):u(m)}return{groupSlides:v}}function co(t,e,o,i,c,s,n){const{align:a,axis:r,direction:f,startIndex:_,loop:l,duration:d,dragFree:h,dragThreshold:u,inViewThreshold:v,slidesToScroll:g,skipSnaps:m,containScroll:x,watchResize:$,watchSlides:S,watchDrag:I,watchFocus:k}=s,y=2,j=zs(),N=j.measure(e),L=o.map(j.measure),D=Ms(r,f),P=D.measureSize(N),z=Vs(P),G=Ps(a,P),W=!l&&!!x,J=l||!!x,{slideSizes:U,slideSizesWithGaps:K,startGap:X,endGap:ct}=so(D,N,L,o,J,c),q=oo(D,P,g,l,N,L,X,ct,y),{snaps:H,snapsAligned:nt}=Xs(D,G,N,L,q),Q=-Y(H)+Y(K),{snapsContained:it,scrollContainLimit:ut}=Gs(P,Q,nt,x,y),V=W?it:nt,{limit:C}=Ws(Q,V,l),B=je(vt(V),_,l),A=B.clone(),O=_t(o),b=({dragHandler:dt,scrollBody:kt,scrollBounds:Ct,options:{loop:xt}})=>{xt||Ct.constrain(dt.pointerDown()),kt.seek()},w=({scrollBody:dt,translate:kt,location:Ct,offsetLocation:xt,previousLocation:Be,scrollLooper:Me,slideLooper:Fe,dragHandler:Ae,animation:ze,eventHandler:Vt,scrollBounds:Ve,options:{loop:Rt}},qt)=>{const Ht=dt.settled(),Re=!Ve.shouldConstrain(),Gt=Rt?Ht:Ht&&Re;Gt&&!Ae.pointerDown()&&(ze.stop(),Vt.emit("settle")),Gt||Vt.emit("scroll");const qe=Ct.get()*qt+Be.get()*(1-qt);xt.set(qe),Rt&&(Me.loop(dt.direction()),Fe.loop()),kt.to(xt.get())},M=Bs(i,c,()=>b(St),dt=>w(St,dt)),R=.68,Z=V[B.get()],tt=pt(Z),rt=pt(Z),st=pt(Z),at=pt(Z),ft=qs(tt,st,rt,at,d,R),bt=Ys(l,V,Q,C,at),yt=Js(M,B,A,ft,bt,at,n),Ft=Ks(C),At=ht(),Te=no(e,o,n,v),{slideRegistry:zt}=Qs(W,x,V,ut,q,O),Pe=Zs(t,o,zt,yt,ft,At,n,k),St={ownerDocument:i,ownerWindow:c,eventHandler:n,containerRect:N,slideRects:L,animation:M,axis:D,dragHandler:Fs(D,t,i,c,at,As(D,c),tt,M,yt,ft,bt,B,n,z,h,u,m,R,I),eventStore:At,percentOfView:z,index:B,indexPrevious:A,limit:C,location:tt,offsetLocation:st,previousLocation:rt,options:s,resizeHandler:Rs(e,n,c,o,D,$,j),scrollBody:ft,scrollBounds:Hs(C,st,at,ft,z),scrollLooper:Us(Q,C,st,[tt,st,rt,at]),scrollProgress:Ft,scrollSnapList:V.map(Ft.get),scrollSnaps:V,scrollTarget:bt,scrollTo:yt,slideLooper:to(D,P,Q,U,K,H,V,st,o),slideFocus:Pe,slidesHandler:eo(e,n,S),slidesInView:Te,slideIndexes:O,slideRegistry:zt,slidesToScroll:q,target:at,translate:be(D,e)};return St}function io(){let t={},e;function o(f){e=f}function i(f){return t[f]||[]}function c(f){return i(f).forEach(_=>_(e,f)),r}function s(f,_){return t[f]=i(f).concat([_]),r}function n(f,_){return t[f]=i(f).filter(l=>l!==_),r}function a(){t={}}const r={init:o,emit:c,off:n,on:s,clear:a};return r}const ro={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function ao(t){function e(s,n){return $e(s,n||{})}function o(s){const n=s.breakpoints||{},a=gt(n).filter(r=>t.matchMedia(r).matches).map(r=>n[r]).reduce((r,f)=>e(r,f),{});return e(s,a)}function i(s){return s.map(n=>gt(n.breakpoints||{})).reduce((n,a)=>n.concat(a),[]).map(t.matchMedia)}return{mergeOptions:e,optionsAtMedia:o,optionsMediaQueries:i}}function lo(t){let e=[];function o(s,n){return e=n.filter(({options:a})=>t.optionsAtMedia(a).active!==!1),e.forEach(a=>a.init(s,t)),n.reduce((a,r)=>Object.assign(a,{[r.name]:r}),{})}function i(){e=e.filter(s=>s.destroy())}return{init:o,destroy:i}}function $t(t,e,o){const i=t.ownerDocument,c=i.defaultView,s=ao(c),n=lo(s),a=ht(),r=io(),{mergeOptions:f,optionsAtMedia:_,optionsMediaQueries:l}=s,{on:d,off:h,emit:u}=r,v=D;let g=!1,m,x=f(ro,$t.globalOptions),$=f(x),S=[],I,k,y;function j(){const{container:O,slides:b}=$;k=(Et(O)?t.querySelector(O):O)||t.children[0];const M=Et(b)?k.querySelectorAll(b):b;y=[].slice.call(M||k.children)}function N(O){const b=co(t,k,y,i,c,O,r);if(O.loop&&!b.slideLooper.canLoop()){const w=Object.assign({},O,{loop:!1});return N(w)}return b}function L(O,b){g||(x=f(x,O),$=_(x),S=b||S,j(),m=N($),l([x,...S.map(({options:w})=>w)]).forEach(w=>a.add(w,"change",D)),$.active&&(m.translate.to(m.location.get()),m.animation.init(),m.slidesInView.init(),m.slideFocus.init(A),m.eventHandler.init(A),m.resizeHandler.init(A),m.slidesHandler.init(A),m.options.loop&&m.slideLooper.loop(),k.offsetParent&&y.length&&m.dragHandler.init(A),I=n.init(A,S)))}function D(O,b){const w=q();P(),L(f({startIndex:w},O),b),r.emit("reInit")}function P(){m.dragHandler.destroy(),m.eventStore.clear(),m.translate.clear(),m.slideLooper.clear(),m.resizeHandler.destroy(),m.slidesHandler.destroy(),m.slidesInView.destroy(),m.animation.destroy(),n.destroy(),a.clear()}function z(){g||(g=!0,a.clear(),P(),r.emit("destroy"),r.clear())}function G(O,b,w){!$.active||g||(m.scrollBody.useBaseFriction().useDuration(b===!0?0:$.duration),m.scrollTo.index(O,w||0))}function W(O){const b=m.index.add(1).get();G(b,O,-1)}function J(O){const b=m.index.add(-1).get();G(b,O,1)}function U(){return m.index.add(1).get()!==q()}function K(){return m.index.add(-1).get()!==q()}function X(){return m.scrollSnapList}function ct(){return m.scrollProgress.get(m.location.get())}function q(){return m.index.get()}function H(){return m.indexPrevious.get()}function nt(){return m.slidesInView.get()}function Q(){return m.slidesInView.get(!1)}function it(){return I}function ut(){return m}function V(){return t}function C(){return k}function B(){return y}const A={canScrollNext:U,canScrollPrev:K,containerNode:C,internalEngine:ut,destroy:z,off:h,on:d,emit:u,plugins:it,previousScrollSnap:H,reInit:v,rootNode:V,scrollNext:W,scrollPrev:J,scrollProgress:ct,scrollSnapList:X,scrollTo:G,selectedScrollSnap:q,slideNodes:B,slidesInView:nt,slidesNotInView:Q};return L(e,o),setTimeout(()=>r.emit("init"),0),A}$t.globalOptions=void 0;function Mt(t={},e=[]){const o=E.useRef(t),i=E.useRef(e),[c,s]=E.useState(),[n,a]=E.useState(),r=E.useCallback(()=>{c&&c.reInit(o.current,i.current)},[c]);return E.useEffect(()=>{Ot(o.current,t)||(o.current=t,r())},[t,r]),E.useEffect(()=>{ws(i.current,e)||(i.current=e,r())},[e,r]),E.useEffect(()=>{if(Es()&&n){$t.globalOptions=Mt.globalOptions;const f=$t(n,o.current,i.current);return s(f),()=>f.destroy()}else s(void 0)},[n,s]),[a,c]}Mt.globalOptions=void 0;const uo=t=>{const[e,o]=E.useState(!0),[i,c]=E.useState(!0),s=E.useCallback(()=>{t&&t.scrollPrev()},[t]),n=E.useCallback(()=>{t&&t.scrollNext()},[t]),a=E.useCallback(r=>{o(!r.canScrollPrev()),c(!r.canScrollNext())},[]);return E.useEffect(()=>{t&&(a(t),t.on("reInit",a).on("select",a))},[t,a]),{prevBtnDisabled:e,nextBtnDisabled:i,onPrevButtonClick:s,onNextButtonClick:n}},fo="_wrapper_7q5cx_14",po="_set_7q5cx_19",mo="_list_7q5cx_27",_o="_item_7q5cx_41",go="_pic_7q5cx_57",ho="_content_7q5cx_76",vo="_head_7q5cx_84",xo="_caption_7q5cx_92",$o="_close_7q5cx_114",jo="_body_7q5cx_132",bo="_data_7q5cx_139",yo="_price_7q5cx_145",So="_count_7q5cx_155",ko="_add_7q5cx_177",Co="_nav_7q5cx_193",No="_navButton_7q5cx_203",Io="_prev_7q5cx_221",Lo="_next_7q5cx_231",Do="_navDisabled_7q5cx_241",Eo="_shine_7q5cx_1",wo={wrapper:fo,set:po,list:mo,item:_o,pic:go,content:ho,head:vo,caption:xo,close:$o,body:jo,data:bo,price:yo,count:So,add:ko,nav:Co,navButton:No,prev:Io,next:Lo,navDisabled:Do,"image-failed":"_image-failed_7q5cx_1",shine:Eo},{wrapper:Oo,set:To,list:Po,item:ye,pic:Se,content:ke,head:Ce,body:Ne,caption:Ie,close:Le,data:De,price:Ee,count:we,add:Oe,nav:Bo,navButton:ie,prev:Mo,next:Fo,navDisabled:re}=wo,Ao=(t,e,o,i,c)=>{const s=()=>{i(!0,"removeBorder","Удаление рамки приведет к удалению комплекта на холсте","Удалить рамку","Оставить рамку")},n=()=>{e&&c([{type:"border",article:e.article,count:o}])};return p.jsxs("li",{className:ye,title:e==null?void 0:e.name,children:[p.jsx("div",{className:Se,children:p.jsx("img",{src:e==null?void 0:e.preview,alt:""})}),p.jsxs("div",{className:ke,children:[p.jsxs("div",{className:Ce,children:[p.jsx("span",{className:Ie,children:e==null?void 0:e.name}),p.jsx("button",{type:"button",className:Le,onClick:s})]}),p.jsxs("div",{className:Ne,children:[p.jsxs("div",{className:De,children:[p.jsxs("span",{className:Ee,children:[e==null?void 0:e.price," ₽"]}),p.jsxs("span",{className:we,children:[o," шт."]})]}),p.jsxs("button",{type:"button",onClick:n,className:`button button_small button_dark button_cart ${Oe}`,children:["В корзину",p.jsx("i",{className:"icon icon_cart"})]})]})]})]},`${t}-border`)},zo=(t,e,o,i,c)=>ve(e).map((n,a)=>{const r=Math.round((typeof n.price=="string"?parseFloat(n.price)*n.selectedCount*o:n.price*n.selectedCount*o)*100)/100,f=()=>{c([{type:"device",article:n.article,count:n.selectedCount*o}])};return p.jsxs("li",{className:ye,title:n==null?void 0:n.name,children:[p.jsx("div",{className:Se,children:p.jsx("img",{src:n==null?void 0:n.preview,alt:""})}),p.jsxs("div",{className:ke,children:[p.jsxs("div",{className:Ce,children:[p.jsx("span",{className:Ie,children:n==null?void 0:n.name}),p.jsx("button",{onClick:()=>i(null,n.id),type:"button",className:Le})]}),p.jsxs("div",{className:Ne,children:[p.jsxs("div",{className:De,children:[p.jsxs("span",{className:Ee,children:[r," ₽"]}),p.jsxs("span",{className:we,children:[n.selectedCount*o," шт.",p.jsxs("i",{children:["(",n.price," р. ед.)"]})]})]}),p.jsxs("button",{type:"button",onClick:f,className:`button button_small button_dark button_cart ${Oe}`,children:["В корзину",p.jsx("i",{className:"icon icon_cart"})]})]})]})]},`${t}-${a}`)}),Vo=()=>{const t=E.useId(),[e,o,i,c,s,n]=et(x=>[x.border,x.countOfSets,x.deviceList,x.removeDevice,x.setModalResetSketch,x.addProductsToCart]),[a,r]=Mt({loop:!1,align:"start",duration:10}),{prevBtnDisabled:f,nextBtnDisabled:_,onPrevButtonClick:l,onNextButtonClick:d}=uo(r),h=E.useMemo(()=>Ao(t,e,o,s,n),[t,e,o,s,n]),u=Object.values(i).filter(Boolean),v=E.useMemo(()=>zo(t,u,o,c,n),[t,u,o,c,n]),g=`button button_dark ${ie} ${Mo} ${f?re:""}`,m=`button button_dark ${ie} ${Fo} ${_?re:""}`;return p.jsxs("div",{className:Oo,children:[p.jsxs("div",{className:Bo,children:[p.jsx("button",{className:g,onClick:l}),p.jsx("button",{className:m,onClick:d})]}),p.jsx("div",{ref:a,className:To,children:p.jsxs("ul",{className:Po,children:[e&&h,v]})})]})},Ro="_locations_1ijvp_14",qo="_item_1ijvp_30",Ho="_text_1ijvp_46",Go="_location_1ijvp_14",Wo="_id_1ijvp_74",Uo="_shine_1ijvp_1",Ko={locations:Ro,item:qo,text:Ho,location:Go,id:Wo,"image-failed":"_image-failed_1ijvp_1",shine:Uo},{locations:Xo,item:ae,text:le,location:ue,id:de}=Ko,Qo=window.userToken,Yo=(t,e,o)=>{const i=[];return e.forEach(c=>{(c.localProject||c.token&&c.token===Qo)&&i.push(p.jsx(he,{caption:c.name,isChecked:c.selected,eventHandler:()=>o(c.id),locationType:"project",projectId:c.id,roomId:null},`${t}-${c.id}`))}),i},Jo=(t,e,o)=>{const i=[];return e.sort((c,s)=>c.default===s.default?0:c.default?1:-1),e.forEach(c=>{i.push(p.jsx(he,{caption:c.name,isChecked:c.selected,eventHandler:()=>o(c.id),editable:c.default,locationType:"room",projectId:null,roomId:c.id},`${t}-${c.id}`))}),i},Zo=()=>{const t=E.useId(),[e,o,i,c,s,n,a]=et(u=>[u.projects,u.addProject,u.rooms,u.addRoom,u.setProject,u.setRoom,u.editConfiguration]),r=E.useMemo(()=>Yo(t,e,s),[t,e,s]),f=E.useMemo(()=>Jo(t,i,n),[t,i,n]),_=e.filter(u=>u.selected)[0],l=i.filter(u=>u.selected)[0],[d,h]=(()=>{let u="",v="";return e.forEach(g=>{var m;g.id===(a==null?void 0:a.projectId)&&!u&&(u=g.name,(m=g.rooms)==null||m.forEach(x=>{x.id===a.roomId&&!v&&(v=x.name)}))}),[u,v]})();return p.jsx("div",{className:Xo,children:a?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:ae,children:p.jsxs("p",{className:le,children:[p.jsx("span",{className:ue,children:d}),p.jsx("span",{className:de,children:"Проект"})]})}),p.jsx("div",{className:ae,children:p.jsxs("p",{className:le,children:[p.jsx("span",{className:ue,children:h}),p.jsx("span",{className:de,children:"Помещение"})]})})]}):p.jsxs(p.Fragment,{children:[p.jsx(pe,{type:"project",cbf:o,title:_?"Проект":"Выбрать проект",placeholder:"Создать проект",selectedValue:_&&_.name,children:r}),p.jsx(pe,{type:"room",cbf:c,title:l?"Помещение":"Выбрать помещение",placeholder:"Создать помещение",selectedValue:l&&l.name,children:f})]})})},tc="_select_1e5gc_14",ec="_select_dropped_1e5gc_21",nc="_collapse_1e5gc_24",sc="_value_1e5gc_38",oc="_caption_1e5gc_54",cc="_text_1e5gc_63",ic="_match_1e5gc_78",rc="_arrow_1e5gc_92",ac="_body_1e5gc_102",lc="_add_1e5gc_119",uc="_inner_1e5gc_127",dc="_shine_1e5gc_1",fc={select:tc,select_dropped:ec,collapse:nc,value:sc,caption:oc,text:cc,match:ic,arrow:rc,body:ac,add:lc,inner:uc,"image-failed":"_image-failed_1e5gc_1",shine:dc},{select:fe,select_dropped:pc,value:mc,caption:_c,text:gc,match:hc,arrow:vc,body:xc,collapse:$c,add:jc,inner:bc}=fc,pe=({type:t,title:e,placeholder:o,children:i,cbf:c,selectedValue:s})=>{const[n,a]=E.useState(!1),r=E.useRef(null),f=n?`${fe} ${pc}`:`${fe}`;return E.useEffect(()=>{const _=l=>{const d=l.target;r.current&&r.current.contains(d)||a(!1),!!d.closest(".closing")&&a(!1)};return document.addEventListener("click",_),()=>document.removeEventListener("click",_)},[]),p.jsxs("div",{ref:r,className:f,children:[p.jsxs("div",{className:mc,onClick:()=>a(!n),children:[p.jsxs("p",{className:_c,children:[p.jsx("span",{className:gc,children:e}),p.jsx("span",{className:hc,children:s})]}),p.jsx("i",{className:vc})]}),p.jsx("div",{className:xc,children:p.jsxs("div",{className:$c,children:[p.jsx("div",{className:jc,children:p.jsx(He,{placeholder:o,cbf:c,type:t})}),p.jsx("ul",{className:bc,children:i})]})})]})},yc="_list_1vr6f_2",Sc="_listVertical_1vr6f_16",kc="_post_1_1vr6f_22",Cc="_post_2_1vr6f_26",Nc="_post_3_1vr6f_30",Ic="_post_4_1vr6f_34",Lc="_post_5_1vr6f_38",Dc="_img_1_1vr6f_42",Ec="_img_2_1vr6f_46",wc="_img_3_1vr6f_50",Oc="_img_4_1vr6f_54",Tc="_img_5_1vr6f_58",Pc="_item_1vr6f_62",Bc="_itemVertical_1vr6f_80",Mc="_close_1vr6f_85",Fc="_image_1vr6f_107",Ac="_withRotate_1vr6f_119",zc="_rotated_1vr6f_123",Vc={list:yc,listVertical:Sc,post_1:kc,post_2:Cc,post_3:Nc,post_4:Ic,post_5:Lc,img_1:Dc,img_2:Ec,img_3:wc,img_4:Oc,img_5:Tc,item:Pc,itemVertical:Bc,close:Mc,image:Fc,withRotate:Ac,rotated:zc},{list:It,listVertical:Rc,item:me,itemVertical:qc,close:Hc,image:_e,rotated:Gc,withRotate:Wc,post_1:Lt,post_2:Uc,post_3:Kc,post_4:Xc,post_5:Qc,img_1:ge,img_2:Yc,img_3:Jc,img_4:Zc,img_5:ti}=Vc,ei=(t,e,o,i,c,s)=>{var f,_,l;const n=[],a=o==="horizontal"?me:`${me} ${(s==null?void 0:s.conf_orientation)==="universal"?`${Gc}`:`${qc}`}`,r=o==="vertical"&&(s==null?void 0:s.conf_orientation)==="universal"&&(s==null?void 0:s.collection.toLocaleUpperCase())==="GLOSSA"?`${_e} ${Wc}`:_e;for(const d in e){const h=parseInt(d);(h===1||h===2||h===3||h===4||h===5)&&n.push(p.jsxs("li",{onClick:()=>e[h]&&c(h),className:a,children:[e[h]?p.jsx("img",{className:r,src:(f=e[h])==null?void 0:f.image,alt:(_=e[h])==null?void 0:_.name,title:(l=e[h])==null?void 0:l.name}):null,e[h]?p.jsx("span",{className:Hc,style:{transform:`scale(${1/(i>1?i:1)})`}}):null]},`${t}-${h}`))}return n},ni=({listRef:t})=>{const[e,o,i,c,s,n]=et(h=>[h.deviceList,h.direction,h.scale,h.removeDevice,h.selectedPost,h.border]),a=E.useId(),r=E.useMemo(()=>ei(a,e,o,i,c,n),[a,e,o,i,c,n]),f={0:"",1:Lt,2:Uc,3:Kc,4:Xc,5:Qc},_={0:"",1:ge,2:Yc,3:Jc,4:Zc,5:ti},l=s.findIndex(Boolean)+1;let d;return o==="horizontal"?d=`${It} ${l===0?`${Lt}`:`${f[l]}`}`:(n==null?void 0:n.conf_orientation)==="vertical"?d=`${It} ${Rc} ${l===0?`${ge}`:`${_[l]}`}`:d=`${It} ${l===0?`${Lt}`:`${f[l]}`}`,p.jsx("ul",{ref:t,className:d,children:r})},si="_button_11v2i_1",oi={button:si},ci="https://storage.yandexcloud.net/shrunk/se-configurator/images/background-default.svg",T={},Dt=(t,e)=>{const o=document.createElement("canvas");o.width=t,o.height=e;const i=o.getContext("2d");return i?{canvas:o,context:i,loaded:!1}:null},ii=()=>{var t;for(const e in T)if(!((t=T[e])!=null&&t.loaded))return!1;return!0},ri=({sketchRef:t,backImgRef:e,borderRef:o,listRef:i})=>{const c=et(l=>l.direction),s=et(l=>l.deviceList),n=(l,d,h)=>{T.background=Dt(l,d);const u=new Image;u.src=h?h.src:ci,u.crossOrigin="anonymous",u.onload=()=>{var $,S;if(!h){if(($=T.background)!=null&&$.canvas){for(let I=0;I<l;I+=40)for(let k=0;k<d;k+=40)T.background.context.drawImage(u,I,k,40,40);T.background.loaded=!0}return}let v,g,m,x;(S=T.background)!=null&&S.canvas&&([v,g,m,x]=Ge(T.background.canvas,u),T.background.context.drawImage(u,v,g,m,x),T.background.loaded=!0)}},a=(l,d,h)=>{if(!h)return;T.border=Dt(l,d);const u=new Image;u.src=h.src,u.crossOrigin="anonymous",u.onload=()=>{var x;const v=window.getComputedStyle(h),g=parseFloat(v.width),m=parseFloat(v.height);(x=T.border)!=null&&x.canvas&&(c==="vertical"?(T.border.context.translate(l/2,d/2),T.border.context.rotate(Math.PI/2),T.border.context.drawImage(u,-g/2,-m/2,g,m)):T.border.context.drawImage(u,(l-g)/2,(d-m)/2,g,m),T.border.loaded=!0)}},r=(l,d,h,u)=>{var v;for(let g=1;g<6;g++){if(!h[g]){delete T[g];continue}T[g]=Dt(l,d);const m=new Image,x=(v=h[g])==null?void 0:v.image;m.src=x||"",m.crossOrigin="anonymous",m.onload=()=>{if(!i.current||!u)return;const $=Object.keys(h).length,S=window.getComputedStyle(u),I=parseFloat(S.width),k=parseFloat(S.height),y=c==="vertical"?(d-I)/2:(d-k)/2,j=c==="vertical"?(l-k)/2:(l-I)/2,N=window.getComputedStyle(i.current),L=parseFloat(N.height),D=(I-L*$)/($+1);let P,z;c==="horizontal"?(P=y+(k-L)/2,z=$===1?j+D:j+(D*g-1)+L*(g-1)):(P=$===1?y+D:y+(D*g-1)+L*(g-1),z=j+(k-L)/2),T[g].context.drawImage(m,z,P,L,L),T[g].loaded=!0}}},f=(l,d)=>{var m,x,$;const h=document.createElement("canvas");h.width=l,h.height=d;const u=h.getContext("2d");if(!u)return;(m=T.background)!=null&&m.canvas&&u.drawImage(T.background.canvas,0,0),(x=T.border)!=null&&x.canvas&&u.drawImage(T.border.canvas,0,0);for(let S=1;S<6;S++){const I=($=T[S])==null?void 0:$.canvas;I&&u.drawImage(I,0,0)}const v=h.toDataURL("image/png"),g=document.createElement("a");g.download="electric-config.png",g.href="data:image/"+v,document.body.appendChild(g),g.click(),document.body.removeChild(g)},_=async()=>{if(!t.current)return;const l=t.current.offsetWidth,d=t.current.offsetHeight;n(l,d,e==null?void 0:e.current),a(l,d,o==null?void 0:o.current),r(l,d,s,o==null?void 0:o.current);const h=setInterval(()=>{ii()&&(clearInterval(h),f(l,d))},100)};return p.jsx("button",{className:oi.button,onClick:_,children:p.jsx("i",{})})},ai="_configuratorWorkspace_1vbxt_14",li="_shine_1vbxt_1",ui={configuratorWorkspace:ai,"image-failed":"_image-failed_1vbxt_1",shine:li},mi=()=>p.jsxs("div",{className:ui.configuratorWorkspace,children:[p.jsx(Jn,{}),p.jsx(ls,{})]});export{mi as default};
