function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _createForOfIteratorHelper(t,e){var r,n,o,a,i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(i)return o=!(n=!0),{s:function(){i=i.call(t)},n:function(){var t=i.next();return n=t.done,t},e:function(t){o=!0,r=t},f:function(){try{n||null==i.return||i.return()}finally{if(o)throw r}}};if(Array.isArray(t)||(i=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length)return i&&(t=i),a=0,{s:e=function(){},n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _regeneratorRuntime(){_regeneratorRuntime=function(){return i};var s,i={},t=Object.prototype,u=t.hasOwnProperty,d=Object.defineProperty||function(t,e,r){t[e]=r.value},e="function"==typeof Symbol?Symbol:{},n=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function a(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(s){a=function(t,e,r){return t[e]=r}}function c(t,e,r,n){var o,a,i,c,e=e&&e.prototype instanceof _?e:_,e=Object.create(e.prototype),n=new q(n||[]);return d(e,"_invoke",{value:(o=t,a=r,i=n,c=h,function(t,e){if(c===m)throw Error("Generator is already running");if(c===p){if("throw"===t)throw e;return{value:s,done:!0}}for(i.method=t,i.arg=e;;){var r=i.delegate;if(r){r=function t(e,r){var n=r.method,o=e.iterator[n];if(o===s)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=s,t(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;n=l(o,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,v;o=n.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=s),r.delegate=null,v):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}(r,i);if(r){if(r===v)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(c===h)throw c=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);c=m;r=l(o,a,i);if("normal"===r.type){if(c=i.done?p:f,r.arg===v)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(c=p,i.method="throw",i.arg=r.arg)}})}),e}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}i.wrap=c;var h="suspendedStart",f="suspendedYield",m="executing",p="completed",v={};function _(){}function y(){}function b(){}var e={},g=(a(e,n,function(){return this}),Object.getPrototypeOf),g=g&&g(g(T([]))),w=(g&&g!==t&&u.call(g,n)&&(e=g),b.prototype=_.prototype=Object.create(e));function L(t){["next","throw","return"].forEach(function(e){a(t,e,function(t){return this._invoke(e,t)})})}function S(i,c){var e;d(this,"_invoke",{value:function(r,n){function t(){return new c(function(t,e){!function e(t,r,n,o){var a,t=l(i[t],i,r);if("throw"!==t.type)return(r=(a=t.arg).value)&&"object"==_typeof(r)&&u.call(r,"__await")?c.resolve(r.__await).then(function(t){e("next",t,n,o)},function(t){e("throw",t,n,o)}):c.resolve(r).then(function(t){a.value=t,n(a)},function(t){return e("throw",t,n,o)});o(t.arg)}(r,n,t,e)})}return e=e?e.then(t,t):t()}})}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function q(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function T(e){if(e||""===e){var r,t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return r=-1,(t=function t(){for(;++r<e.length;)if(u.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=s,t.done=!0,t}).next=t}throw new TypeError(_typeof(e)+" is not iterable")}return d(w,"constructor",{value:y.prototype=b,configurable:!0}),d(b,"constructor",{value:y,configurable:!0}),y.displayName=a(b,o,"GeneratorFunction"),i.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,a(t,o,"GeneratorFunction")),t.prototype=Object.create(w),t},i.awrap=function(t){return{__await:t}},L(S.prototype),a(S.prototype,r,function(){return this}),i.AsyncIterator=S,i.async=function(t,e,r,n,o){void 0===o&&(o=Promise);var a=new S(c(t,e,r,n),o);return i.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},L(w),a(w,o,"Generator"),a(w,n,function(){return this}),a(w,"toString",function(){return"[object Generator]"}),i.keys=function(t){var e,r=Object(t),n=[];for(e in r)n.push(e);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},i.values=T,q.prototype={constructor:q,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=s)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function t(t,e){return a.type="throw",a.arg=r,n.next=t,e&&(n.method="next",n.arg=s),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],a=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var i=u.call(o,"catchLoc"),c=u.call(o,"finallyLoc");if(i&&c){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var a=(o=o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc?null:o)?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),E(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r,n,o=this.tryEntries[e];if(o.tryLoc===t)return"throw"===(r=o.completion).type&&(n=r.arg,E(o)),n}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:T(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=s),v}},i}function asyncGeneratorStep(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(c){return function(){var t=this,i=arguments;return new Promise(function(e,r){var n=c.apply(t,i);function o(t){asyncGeneratorStep(n,e,r,o,a,"next",t)}function a(t){asyncGeneratorStep(n,e,r,o,a,"throw",t)}o(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0===r)return("string"===e?String:Number)(t);r=r.call(t,e||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){var r;if(t)return"string"==typeof t?_arrayLikeToArray(t,e):"Map"===(r="Object"===(r={}.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}window.debounce=function(r,n){var o;return function(){var t=this,e=arguments;clearTimeout(o),o=setTimeout(function(){r.apply(t,e)},n)}},window.formatDate=function(t){var e,r,t=new Date(t);return isNaN(t.getTime())?"":(e=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),t=t.getFullYear(),"".concat(e,".").concat(r,".").concat(t))},window.formatNumber=function(t){var t=t.toString().split("."),e=t[0].replace(/\B(?=(\d{3})+(?!\d))/g," ");return 1<t.length?e+","+t[1].replace(".",","):e},window.smoothScrollToElement=function(t){var r,n,o;t?(t=t.getBoundingClientRect().top+window.scrollY-20,n=t-(r=window.scrollY),o=null,requestAnimationFrame(function t(e){e-=o=o||e,e=Math.min(e/300,1);window.scrollTo(0,r+n*e),e<1&&requestAnimationFrame(t)})):console.warn("На странице нет элемента к которому нужно проскролить экран.")},window.throttle=function(t,e){var r,n,o=!1;function a(){o?(r=arguments,n=this):(t.apply(this,arguments),o=!0,setTimeout(function(){o=!1,r&&(a.apply(n,r),r=n=null)},e))}return a},window.validateEmail=function(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)},window.validatePhone=function(t){return/^7\d{10}$/.test(t)};var FOOTER_HIDDEN_OFFSET=50,initBackToOrdersButton=function(){var r=document.getElementById("backToOrdersButton"),n=document.getElementById("footer");function t(){var t=r.getBoundingClientRect(),e=n.getBoundingClientRect(),t=t.bottom;e.top-FOOTER_HIDDEN_OFFSET<=t?r.classList.add("hidden"):r.classList.remove("hidden")}r&&n&&(window.addEventListener("scroll",t),t())};function initializingFavoriteButtons(){var t=document.querySelectorAll(".card-top__btn_favorite"),e=document.querySelectorAll(".card-product__actions-item_favorite i"),t=[].concat(_toConsumableArray(Array.from(t)),_toConsumableArray(Array.from(e)));0!==t.length&&t.forEach(function(t){t.hasAttribute("data-inited")||(t.dataset.inited="",new FavoriteButton(t).init())})}document.addEventListener("DOMContentLoaded",initBackToOrdersButton),window.addEventListener("load",function(){initializingFavoriteButtons()});var FavoriteButton=function(){return _createClass(function t(e){_classCallCheck(this,t),this.button=e,this.clickHandler=this.clickHandler.bind(this)},[{key:"init",value:function(){var e=this;this.button.addEventListener("click",function(t){t.preventDefault(),e.clickHandler()})}},{key:"clickHandler",value:function(){var t=this.button.classList.contains("checked"),e=this.checkErrors();e.isError?e.errors.forEach(function(t){return console.error(t)}):this.request(t?"remove":"add")}},{key:"checkErrors",value:function(){var t=!1,e=[];return this.button.dataset.id||(t=!0,e.push("Не указан id продукта в обработчике добавления/удаления товара в Избранное!")),window.addToFavoriteLink||(t=!0,e.push("Некорректный URL API добавить товар в Избранное! (window.addToFavoriteLink)")),window.removeFromFavoriteLink||(t=!0,e.push("Некорректный URL API удалить товар из Избранного! (window.removeFromFavoriteLink)")),{isError:t,errors:e}}},{key:"request",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o,a;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.button.dataset.id,n="add"===e?window.addToFavoriteLink:window.removeFromFavoriteLink,(a=new FormData).append("product",r),t.prev=4,t.next=7,fetch(n,{method:"POST",body:a,credentials:"include"});case 7:if((o=t.sent).ok){t.next=11;break}throw a="Ошибка запроса ".concat("add"===e?"добавления":"удаления"," товара ").concat("add"===e?"в Избранное":"из Избранного","! API URL: ").concat(n),new Error(a);case 11:return t.next=13,o.json();case 13:if("error"===t.sent.status)throw new Error("Не получилось добавить товар id: ".concat(r," в Избранное! API URL: ").concat(n));t.next=16;break;case 16:"add"===e?this.button.classList.add("checked"):this.button.classList.remove("checked"),"remove"===e&&this.removeParentCard(),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(4),console.error(t.t0);case 23:case"end":return t.stop()}},t,this,[[4,20]])})),function(t){return e.apply(this,arguments)})},{key:"removeParentCard",value:function(){var t=this.button.closest(".favorite__item");t&&t.remove()}}]);var e}();function showOrderWar(t,e){var r,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,o=document.querySelector(t);o&&(e&&(o.querySelector(".order-war__order-number").innerText="№ "+e),n&&"string"==typeof n.order_url&&(o.querySelector("a.order_url").href=n.order_url),r=o.querySelector(".order-war__body"),o.classList.add("visible"),setTimeout(function(){o.classList.add("show"),r.classList.add("visible")},10))}function hideOrderWar(t){var e=document.querySelector(t);e&&((t=e.querySelector(".order-war__order-number"))&&(t.innerText=""),e.querySelector(".order-war__body").classList.remove("visible"),e.classList.remove("show"),setTimeout(function(){return e.classList.remove("visible")},300))}function initOrderLoggedWar(){var t=document.querySelector("#orderLoggedWar");t&&(t.querySelector(".close").addEventListener("click",function(){return hideOrderWar("#orderLoggedWar")}),document.addEventListener("click",function(t){t.target.closest(".order-war__body")||hideOrderWar("#orderLoggedWar")}))}function initAddProductWar(){var t=document.querySelector("#orderAddProductWar");t&&(t.querySelector(".close").addEventListener("click",function(){return hideOrderWar("#orderAddProductWar")}),t.querySelector("button").addEventListener("click",function(){addProductToOrder(),hideOrderWar("#orderAddProductWar")}),document.addEventListener("click",function(t){t.target.closest(".order-war__body")||hideOrderWar("#orderAddProductWar")}))}function initRequestErr(){var t=document.querySelector("#orderError");t&&(t.querySelectorAll(".close").forEach(function(t){return t.addEventListener("click",function(){return hideOrderWar("#orderError")})}),document.addEventListener("click",function(t){t.target.closest(".order-war__body")||hideOrderWar("#orderError")}))}function initRequestApproved(){var t=document.querySelector("#orderApproved");t&&(t.querySelectorAll(".close").forEach(function(t){return t.addEventListener("click",function(){return hideOrderWar("#orderApproved")})}),document.addEventListener("click",function(t){t.target.closest(".order-war__body")||hideOrderWar("#orderApproved")}))}function initAddProductNewOrder(){var t=document.querySelector("#orderAddProductNewOrder");t&&(t.querySelector(".close").addEventListener("click",function(){return hideOrderWar("#orderAddProductNewOrder")}),t.querySelector("button").addEventListener("click",function(){addProductToOrder(),hideOrderWar("#orderAddProductNewOrder")}),document.addEventListener("click",function(t){t.target.closest(".order-war__body")||hideOrderWar("#orderAddProductNewOrder")}))}function initFastView(){var t;document.querySelector(".catalog_iframe")||0!==(t=document.querySelectorAll("._js-open-fast-view")).length&&t.forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),showOrderWar("#fastView"),getCardDetails(e),initModalQuantityChanger();t=e.dataset.productArticle;t&&requestBuyWithProduct(t)})})}function hideFastView(){var t=document.querySelector("#fastView");t&&(t.querySelector(".close").addEventListener("click",function(){return hideOrderWar("#fastView")}),t.querySelector("._js-modal-add").addEventListener("click",function(){checkAddProductButton(),hideOrderWar("#fastView")}),document.addEventListener("click",function(t){t.target.closest(".order-war__body")||hideOrderWar("#fastView")}))}function initModalQuantityChanger(){var e=document.querySelector("#fastView ._js-modal-quantity"),t=document.querySelector("#fastView .changer__btn_minus"),r=document.querySelector("#fastView .changer__btn_plus"),n=Number(e.value);function o(t){n=Math.max(1,t),e.value=n,gettingTheFullCost()}t.addEventListener("click",function(){return o(n-1)}),r.addEventListener("click",function(){return o(n+1)}),e.addEventListener("change",function(){var t=parseInt(e.value,10);o(isNaN(t)||t<1?1:t)})}function gettingTheFullCost(){var t,e=document.querySelector("._js-modal-price");e&&(e=e.textContent.replace(/\s/g,""),t=document.querySelector("._js-modal-quantity").value,e=parseFloat(e.replace(/,/g,"."))*parseFloat(t),document.querySelector("._js-modal-total").innerHTML=e?e.toLocaleString("ru"):"0")}function getCardDetails(t){function e(t,e){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=e.closest(".card-top__price-item");t?(e.innerHTML=parseFloat(t.replace(/,/g,".")).toLocaleString("ru"),null!=n&&n.classList.remove("hidden")):null!=n&&n.classList.add("hidden"),r?null!=n&&n.classList.add("card-top__price_crossed"):null!=n&&n.classList.remove("card-top__price_crossed")}var t=t.closest("._js-card-product"),r=t.dataset.id,n=t.dataset.image,o=t.dataset.title,a=t.dataset.article,i=t.dataset.stock,c=t.dataset.rrc_price,s=t.dataset.price_sale,u=t.dataset.opt_price,d=Boolean(t.dataset.sale),l=Boolean(t.dataset.rec_showed),h=Boolean(t.dataset.opt_showed),t=parseInt(t.querySelector("._js-card-quantity").value),f=document.querySelector("._js-modal-add"),m=document.querySelector("._js-modal-image"),p=document.querySelector("._js-modal-name"),v=document.querySelector("._js-modal-code"),_=document.querySelector("._js-modal-count"),y=document.querySelector("._js-modal-price-rrc"),b=document.querySelector("._js-modal-price-sale"),g=document.querySelector("._js-modal-price"),w=document.querySelector("._js-modal-quantity"),L=document.querySelector("._js-modal-total");f.dataset.productId=r,m.src=n,p.textContent=o,v.textContent=a,_.innerHTML=i,w.value=t,L.innerHTML=(Number(parseFloat((null!=(r=null!=(f=null!=u?u:s)?f:c)?r:"0").replace(/,/g,".")))*parseFloat(t)).toLocaleString("ru");l?d?(e(c,y,!0),e(s,b)):(e(c,y),e(!1,b)):(e(!1,y),e(!1,b)),e(!(!h||!u)&&u,g)}function initSuccess(){var t=document.querySelector("#success");t&&(t.querySelector(".close").addEventListener("click",function(){return hideOrderWar("#success")}),t.querySelector("button").addEventListener("click",function(){hideOrderWar("#success")}),document.addEventListener("click",function(t){t.target.closest(".order-war__body")||hideOrderWar("#success")}))}var buyWithProductModalSwiper=void 0;function requestBuyWithProduct(t){return _requestBuyWithProduct.apply(this,arguments)}function _requestBuyWithProduct(){return(_requestBuyWithProduct=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o,a,i;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=document.querySelector("#fastView"),e||r){t.next=3;break}return t.abrupt("return");case 3:if(n=r.querySelector(".modal__slider")){t.next=6;break}return t.abrupt("return");case 6:if(t.prev=6,n.classList.add("pending"),n.classList.remove("fulfilled","rejected"),o=window.buyWithProductApiLink){t.next=12;break}throw new Error("Отсутствует ссылка на API: С этим товаром покупают [window.buyWithProductApiLink]");case 12:return t.next=14,fetch(o);case 14:if((a=t.sent).ok){t.next=17;break}throw new Error("Ошибка запроса к API: С этим товаром покупают");case 17:return t.next=19,a.json();case 19:i=t.sent,setTimeout(function(){initModalSwiper(i.data,r),n.classList.remove("pending"),n.classList.add("fulfilled")},2e3),t.next=28;break;case 23:t.prev=23,t.t0=t.catch(6),n.classList.remove("pending"),n.classList.add("rejected"),console.error(t.t0);case 28:case"end":return t.stop()}},t,null,[[6,23]])}))).apply(this,arguments)}function initModalSwiper(t,e){var n;(t||t.length||e)&&(buyWithProductModalSwiper&&buyWithProductModalSwiper.destroy(!0,!0),(n=e.querySelector("#buyWithProductList")).replaceChildren(),t.forEach(function(t){var e=document.createElement("div"),r=(e.className="swiper-slide modal__slider-slide",parseFloat(t.price.replace(/\s/g,"").replace(/,/g,".")).toLocaleString("ru"));e.innerHTML='\n\t\t\t<div class="modal__slider-card">\n\t\t\t\t'.concat("true"===t.new?'<mark class="modal__slider-card-new">new</mark>':"",'\n\t\t\t\t<i class="modal__slider-card-picture">\n\t\t\t\t\t<img src="').concat(t.image,'" alt="').concat(t.title,'" loading="lazy">\n\t\t\t\t</i>\n\t\t\t\t<div class="modal__slider-card-body">\n\t\t\t\t\t<div class="modal__slider-card-caption">\n\t\t\t\t\t\t<a href="').concat(t.href,'" title="').concat(t.title,'" target="_blank">\n\t\t\t\t\t\t\t<strong>').concat(t.title,"</strong>\n\t\t\t\t\t\t\t<span>").concat(t.article,'</span>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<button type="button" class="modal__slider-card-favorite ').concat("true"===t.favorite?"selected":"",'" data-article="').concat(t.article,'"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="modal__slider-card-price">\n\t\t\t\t\t\t<p>').concat(r,' руб.</p>\n\t\t\t\t\t\t<button type="button" class="modal__slider-card-buy" data-article="').concat(t.article,'"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'),n.appendChild(e)}),t=e.querySelector(".swiper"))&&(buyWithProductModalSwiper=new Swiper(t,{loop:!1,slidesPerView:"auto",observer:!0,observeParents:!0,observeSlideChildren:!0,watchOverflow:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}),initAddToFavoriteForBuyWithProduct())}function initAddToFavoriteForBuyWithProduct(){var t=document.querySelector("#buyWithProductList"),e=t.querySelectorAll(".modal__slider-card-favorite"),t=t.querySelectorAll(".modal__slider-card-buy");e.forEach(function(e){return e.addEventListener("click",function(){e.classList.toggle("selected");var t=e.dataset.article;t&&alert("Добавляем товара ".concat(t," в Избранное"))})}),t.forEach(function(e){return e.addEventListener("click",function(){e.classList.toggle("selected");var t=e.dataset.article;t&&alert("Добавляем товара ".concat(t," в Корзину"))})})}function wrapSubstringInBold(t,e){e=new RegExp(e,"gi");return e.test(t)?t.replace(e,"<b>$&</b>"):t}function showSearchLoading(){document.querySelector("#loadingSearch").classList.add("visible")}function hideSearchLoading(){document.querySelector("#loadingSearch").classList.remove("visible")}function checkShowAllSearchResults(t,e,r){var n=document.getElementById("searchingShowAll"),o=n.querySelector("span"),a=(n.classList.remove("visible"),window.catalogLink);a?t<=e||(o.innerText="(".concat(t,")"),n.href="".concat(a,"?query=").concat(r),n.classList.add("visible")):console.error("Не корректный URL Показать все товары в поисковой выдаче!")}function checkSearchButton(t){var e=document.getElementById("searchButton"),r=window.catalogLink;e.removeAttribute("href"),r&&t&&(e.href="".concat(r,"?query=").concat(t))}window.addEventListener("load",function(){initOrderLoggedWar(),initAddProductWar(),initRequestErr(),initRequestApproved(),initAddProductNewOrder(),initFastView(),hideFastView(),gettingTheFullCost(),initSuccess()});var debouncedSearchRequest=window.debounce(_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,r,n,o;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.querySelector(".search__input"),""===(e=e.value.trim()))return document.querySelector("#searchingResults").classList.remove("success","fail"),checkSearchButton(),t.abrupt("return");t.next=7;break;case 7:if(!(3<=e.length)){t.next=29;break}if(t.prev=8,r=window.searchRequestLink){t.next=12;break}throw new Error("Не корректный URL API поиска!");case 12:return showSearchLoading(),r+=e,t.next=16,fetch(r);case 16:if((n=t.sent).ok){t.next=19;break}throw new Error("Ошибка запроса поиска!");case 19:return t.next=21,n.json();case 21:updateSearchResult(e,o=t.sent),console.log("API Response",o),t.next=29;break;case 26:t.prev=26,t.t0=t.catch(8),console.error("Search API Request -",t.t0);case 29:case"end":return t.stop()}},t,null,[[8,26]])})),700);function initSearching(){var t=document.querySelector(".search__reset"),e=document.querySelector(".search__input");e&&e.addEventListener("input",function(){""!==e.value?t.classList.add("visible"):t.classList.remove("visible"),debouncedSearchRequest()})}function updateSearchResult(e,t){var r=t.count,t=t.data,n=document.querySelector("#searchingResults"),o=n.querySelector("#searchingList");if(n.classList.remove("success","fail"),hideSearchLoading(),0===t.length)n.classList.add("fail");else{for(;o.firstChild;)o.removeChild(o.firstChild);var a="";t.forEach(function(t){a+='\n<li>\n    <a class="search__item" href="'.concat(t.url,'">\n        <i><img src="').concat(t.image,'" alt="').concat(t.title,'" /></i>\n        <span>\n            <mark>').concat(wrapSubstringInBold(t.title,e),"</mark>\n            <em><span>").concat(window.formatNumber(t.price)," р.</span> ").concat(t.in_stock,"</em>\n        </span>\n    </a>\n</li>")}),o.innerHTML=a,n.classList.add("success"),checkShowAllSearchResults(r,t.length,e),checkSearchButton(e)}}function initToggleMobileSearch(){var e=document.querySelector("#search"),r=document.querySelector("#mobileSearchToggler"),n=document.querySelector(".nav-mobile");e&&r&&n&&r.addEventListener("click",function(){var t=0;n.classList.contains("visible")&&(n.classList.remove("visible"),t=300),setTimeout(function(){e.classList.contains("visible")?resetSearch():(e.classList.add("visible"),r.classList.add("active"))},t)})}function initToggleMobileSearchToNav(){var t=document.querySelector(".search__burger"),e=document.querySelector(".nav-mobile");t&&e&&t.addEventListener("click",function(){resetSearch(),setTimeout(function(){return e.classList.add("visible")},300)})}function activeInactiveSearch(){var t=document.querySelector(".search__input");t&&t.addEventListener("focus",activateSearch)}function activateSearch(){window.innerWidth<1200||document.querySelector("#search").classList.add("active")}function resetSearch(){var t=document.querySelector("#searchingResults"),e=document.querySelector("#mobileSearchToggler"),r=document.querySelector("#search"),n=document.querySelector(".search__reset"),o=document.querySelector(".search__input");t.classList.remove("success","fail"),e.classList.remove("active"),r.classList.remove("visible"),r.classList.remove("active"),n.classList.remove("visible"),o.value="",o.blur(),hideSearchLoading(),checkSearchButton()}function initResetInputValue(){var t=document.querySelector("#resetSearchText"),e=document.querySelector(".search__back");t&&e&&(t.addEventListener("click",resetSearch),e.addEventListener("click",resetSearch))}window.addEventListener("scroll",function(){var t=document.getElementById("search");t&&t.classList.contains("active")&&100<window.scrollY&&resetSearch()}),window.addEventListener("load",function(){initSearching(),initResetInputValue(),initToggleMobileSearch(),initToggleMobileSearchToNav(),activeInactiveSearch()});var ShareLinks=function(){return _createClass(function t(e){_classCallCheck(this,t),this.node=e,this.links=JSON.parse(this.node.dataset.links),this.parent=this.node.parentNode,this.onDocument(),this.onWindow()},[{key:"init",value:function(){var e=this;this.parent.addEventListener("click",function(t){t.target.classList.contains("share-tooltip__link")||(e.parent.querySelector(".share-tooltip__list")?e.remove():(e.node.appendChild(e.createChildList()),e.show()))})}},{key:"createChildList",value:function(){var n=document.createElement("ul");return n.classList.add("share-tooltip__list"),this.links.forEach(function(t){var e=document.createElement("li"),r=(e.classList.add("share-tooltip__item"),document.createElement("a"));r.classList.add("share-tooltip__link","share-tooltip__link_".concat(t.name)),r.href=t.link,r.target="_blank",e.appendChild(r),n.appendChild(e)}),n}},{key:"show",value:function(){this.node.classList.add("visible")}},{key:"hide",value:function(){this.node.classList.remove("visible")}},{key:"remove",value:function(){for(;this.node.firstChild;)this.node.removeChild(this.node.firstChild);this.hide()}},{key:"onDocument",value:function(){var e=this;document.addEventListener("click",function(t){e.parent.contains(t.target)||e.remove()})}},{key:"onWindow",value:function(){var t=this;window.addEventListener("scroll",function(){return t.remove()})}}])}();function initShares(){var t=document.querySelector(".share-tooltip");t&&new ShareLinks(t).init()}window.addEventListener("load",initShares);var showSpinner=function(){var t=document.getElementById("spinner");t.classList.add("display"),setTimeout(function(){return t.classList.add("visible")},100)},hideSpinner=function(){var t=document.getElementById("spinner");t.classList.remove("visible"),setTimeout(function(){return t.classList.remove("display")},1e3)},initHeaderScripts=(window.addEventListener("load",function(){document.getElementById("spinner")&&(window.spinner.show=showSpinner,window.spinner.hide=hideSpinner)}),function(){var t=document.querySelector(".header-info__menu--burger"),e=document.querySelector(".nav-mobile"),r=document.querySelector(".nav-mobile__header_close"),n=document.querySelector(".nav-mobile__open-icon");t&&e&&r&&n&&(t.addEventListener("click",function(){e.classList.add("visible"),n.classList.remove("nav-mobile__open-icon_active"),document.querySelector(".nav-mobile__list_drop").classList.remove("nav-mobile__list_drop-open"),document.querySelectorAll(".drop-submenu__list").forEach(function(t){t.classList.remove("drop-submenu__list_open")}),document.querySelectorAll(".drop-submenu__item").forEach(function(t){t.classList.remove("drop-submenu__item_open")})}),r.addEventListener("click",function(){e.classList.remove("visible")}),e.addEventListener("click",function(t){(t.target.classList.contains("nav-mobile__link_drop")||t.target.classList.contains("nav-mobile__open-icon"))&&(t.preventDefault(),t.target.closest(".nav-mobile__list").querySelector(".nav-mobile__list_drop").classList.toggle("nav-mobile__list_drop-open"),n.classList.toggle("nav-mobile__open-icon_active")),(t.target.classList.contains("drop-submenu__title")||t.target.classList.contains("drop-submenu__plus"))&&(t.target.closest(".drop-submenu__item").querySelector(".drop-submenu__list").classList.toggle("drop-submenu__list_open"),t.target.closest(".drop-submenu__item").classList.toggle("drop-submenu__item_open"))}))}),initHeaderTooltips=function(){var t=document.querySelectorAll(".header-info__btn:has(.header-info__tooltip a)");t.length&&t.forEach(function(e){return e.addEventListener("click",function(){var t=e.querySelector(".header-info__tooltip");t&&toggleHeaderTooltipVisible(t)})})},initHeaderTooltipHide=function(){window.addEventListener("scroll",hideAllHeaderTooltips),document.addEventListener("click",function(t){var e,t=t.target;t.closest(".header-info__btn")?(e=t.querySelector(".header-info__tooltip"),hideAllHeaderTooltips(),setTimeout(function(){return toggleHeaderTooltipVisible(e)},10)):hideAllHeaderTooltips()})};function toggleHeaderTooltipVisible(t){t&&t.classList.toggle("visible")}function hideAllHeaderTooltips(t){var e=document.querySelectorAll(".header-info__tooltip");e&&e.forEach(function(t){return t.classList.remove("visible")})}window.addEventListener("load",function(){initHeaderScripts(),initHeaderTooltips(),initHeaderTooltipHide()});var initProductCounters=function(){function i(t,e){t&&(e="string"==typeof e?""===e?1:parseInt(e):e,t.dataset.productCount=e)}var t=document.querySelectorAll(".card-top__quantity_changer");t.forEach(function(t){var e=t.parentNode.querySelector(".card-product__bottom-buy"),r=t.querySelector(".changer__input"),n=t.querySelector(".changer__btn_minus"),o=t.querySelector(".changer__btn_plus");var a=Number(r.value);r.addEventListener("keyup",function(t){"0"==t.currentTarget.value&&(t.currentTarget.value=1),a=Number(r.value),gettingTheFullCost(),"Enter"===t.key&&t.currentTarget.blur()}),r.addEventListener("keypress",function(t){var e;31<(e=(t=t).which||t.keyCode)&&(e<48||57<e)&&t.preventDefault(),gettingTheFullCost()}),r.addEventListener("change",function(t){(!t.currentTarget.value||t.currentTarget.value<1)&&(t.currentTarget.value=1),a=Number(r.value),gettingTheFullCost()}),r.addEventListener("input",function(t){(t.currentTarget.value<=1?(n.classList.add("changer__btn_disabled"),o):n).classList.remove("changer__btn_disabled"),9998<t.currentTarget.value?(n.classList.remove("changer__btn_disabled"),o.classList.add("changer__btn_disabled")):o.classList.remove("changer__btn_disabled"),gettingTheFullCost(),i(e,r.value)}),r.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation()}),n.addEventListener("click",function(t){t.preventDefault(),a--,r.value=a,r.value||(r.value=1,n.classList.add("changer__btn_disabled"),o.classList.remove("changer__btn_disabled")),(r.value<=1?(r.value=1,n.classList.add("changer__btn_disabled"),o):n).classList.remove("changer__btn_disabled"),gettingTheFullCost(),i(e,a)}),o.addEventListener("click",function(t){t.preventDefault(),a++,n.classList.remove("changer__btn_disabled"),r.value=a,9998<r.value?(r.value=9999,o.classList.add("changer__btn_disabled")):o.classList.remove("changer__btn_disabled"),gettingTheFullCost(),i(e,a)})})};function initCustomSelects(t){t=document.querySelectorAll(t);t.length&&t.forEach(function(n){n.dataset.init||(n.dataset.init="true",n.addEventListener("click",function(t){return e=n,(t=t).stopPropagation(),void("INPUT"!==t.target.tagName?e.classList.toggle("custom-select--open"):(t=t.target.closest(".custom-select__option"))&&((r=e.querySelector(".custom-select__value")).textContent=t.dataset.orderId?"№ ".concat("null"!==t.dataset.number1c?t.dataset.number1c:t.dataset.article," от ").concat(t.dataset.created):"Новый заказ",r.dataset.orderId=t.dataset.orderId,r.dataset.article=t.dataset.article,r.dataset.number1c=t.dataset.number1c,r.dataset.created=t.dataset.created,r.dataset.status=t.dataset.status,r.dataset.statusText=t.dataset.statusText,r.dataset.selected="true",r=e.closest(".card-top__order-wrap"))&&(e=r.querySelector(".card-top__order-status mark"))&&(e.textContent=t.dataset.orderId?t.dataset.statusText:""));var e,r}))})}function getListOrders(){return _getListOrders.apply(this,arguments)}function _getListOrders(){return(_getListOrders=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetchListOrdersData();case 3:updateListOrders(".card",e=t.sent,"product-card-order"),updateListOrders(".modal",e,"modal-card-order"),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.debug("Ошибка при получении заказов залогиненого пользователя:",t.t0);case 11:case"end":return t.stop()}},t,null,[[0,8]])}))).apply(this,arguments)}function fetchListOrdersData(){return _fetchListOrdersData.apply(this,arguments)}function _fetchListOrdersData(){return(_fetchListOrdersData=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,r;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=window.listOrders){t.next=4;break}return console.debug("Не корректный URL для списка заказов!"),t.abrupt("return");case 4:return t.next=6,fetch(e,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});case 6:if((r=t.sent).ok){t.next=9;break}throw new Error("Ошибка сети при получении данных с ".concat(e));case 9:return t.next=11,r.json();case 11:return t.abrupt("return",t.sent.data);case 13:case"end":return t.stop()}},t)}))).apply(this,arguments)}function updateListOrders(t,e,r){var n=document.querySelector("".concat(t," .custom-select__list")),t=document.querySelector("".concat(t," .custom-select__value"));n&&t&&e&&appendListOrders(n,t,e,r)}function appendListOrders(n,o,t,a){var e=t.find(function(t){return t.default}),i=!o.dataset.selected;n.innerHTML="",n.insertAdjacentHTML("beforeend",'\n\t\t<li class="custom-select__item custom-select__item--sort">\n\t\t\t<label class="custom-select__option"\n\t\t\t\t\tdata-status="NEW_ORDER"\n\t\t\t\t\tdata-status-text="Новый заказ">\n\t\t\t\t<input class="invisible" type="radio" name="'.concat(a,'" ').concat(!e&&i||"NEW_ORDER"===o.dataset.status?"checked":"",">\n\t\t\t\t<span>Новый заказ</span>\n\t\t\t</label>\n\t\t</li>")),t.forEach(function(t){var e=window.formatDate(t.meta.created_at),r=!(!t.default||!i)||o.dataset.article===t.number;n.insertAdjacentHTML("beforeend",'\n\t\t\t<li class="custom-select__item custom-select__item--sort">\n\t\t\t\t<label class="custom-select__option"\n\t\t\t\t\t\tdata-order-id="'.concat(t.id,'"\n\t\t\t\t\t\tdata-article="').concat(t.number,'"\n\t\t\t\t\t\tdata-number1c="').concat(t.number_1c,'"\n\t\t\t\t\t\tdata-created="').concat(e,'"\n\t\t\t\t\t\tdata-status="').concat(t.status.current.name,'"\n\t\t\t\t\t\tdata-status-text="').concat(t.status.current.label,'">\n\t\t\t\t\t<input class="invisible" type="radio" name="').concat(a,'" ').concat(r?"checked":"",">\n                    <span>").concat(["Заказ №",t.number_1c,t.number].filter(Boolean).join(" "),"</span>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<i>от ").concat(e,"</i>\n\t\t\t\t\t\t<mark>").concat(t.status.current.label,"</mark>\n\t\t\t\t\t</div>\n\t\t\t\t</label>\n\t\t\t</li>")),t.default&&i&&(o.textContent="№ ".concat(t.number_1c||t.number," от ").concat(e),o.dataset.orderId="".concat(t.id),o.dataset.article="".concat(t.number),o.dataset.number1c="".concat(t.number_1c),o.dataset.created="".concat(e),o.dataset.status="".concat(t.status.current.name),o.dataset.statusText="".concat(t.status.current.label))})}function checkAddProductButton(){switch(document.querySelector(".card-top__order").querySelector(".custom-select__value").dataset.status){case"NEW_ORDER":showOrderWar("#orderAddProductNewOrder");break;case"RESERVED":showOrderWar("#orderAddProductWar");break;default:addProductToOrder()}}function addProductToOrder(){return _addProductToOrder.apply(this,arguments)}function _addProductToOrder(){return(_addProductToOrder=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,r,n,o,a,i,c,s,u,d,l,h,f,m,p,v;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.querySelector(".card .card-top__quantity .changer__input")||document.querySelector(".modal .card-top__quantity .changer__input"),e=e.value,o=document.querySelector(".card-top__btn_order[data-product-id]"),n=document.querySelector(".card-top__order"),r=n.querySelector(".custom-select__value"),n=r.dataset.orderId,o=o.dataset.productId,a="NEW_ORDER"===r.dataset.status,i=window.addProductApiLink,c=new FormData,n&&c.append("order",n),c.append("product",o),c.append("count",e),t.prev=13,i){t.next=16;break}throw new Error("Не корректный api url для добавления товара!");case 16:window.spinner.show(),s={},u=_createForOfIteratorHelper(c.entries());try{for(u.s();!(d=u.n()).done;)l=d.value,s[l[0]]=l[1]}catch(t){u.e(t)}finally{u.f()}return console.log("Add product Request:",s),t.next=23,fetch(i,{method:"POST",body:c,credentials:"include"});case 23:if((h=t.sent).ok){t.next=26;break}throw new Error("Ошибка добавления товара!");case 26:return t.next=28,h.json();case 28:m=(f=t.sent).data.number,p=f.data.number_1c||f.data.id,v=window.formatDate(f.data.meta.created_at),setTimeout(function(){var t;window.spinner.hide(),showOrderWar("#orderApproved","".concat(m," ").concat(p," от ").concat(v),f.data),document.querySelector(".card-top__quantity .changer__input").value=1,a&&(t=document.querySelector(".card")||document.querySelector(".modal"))&&(updateSelectedOrderValue(f.data,r),addNewOptionToOrderSelector(f.data,t)),getListOrders()},1e3),t.next=39;break;case 35:t.prev=35,t.t0=t.catch(13),console.error(t.t0),setTimeout(function(){window.spinner.hide(),showOrderWar("#orderError")},1e3);case 39:case"end":return t.stop()}},t,null,[[13,35]])}))).apply(this,arguments)}function updateSelectedOrderValue(t,e){var r=window.formatDate(t.meta.created_at);e.textContent="№ ".concat(t.number_1c||t.id," от ").concat(r),e.dataset.orderId="".concat(t.id),e.dataset.article="".concat(t.number),e.dataset.number1c="".concat(t.number_1c),e.dataset.created="".concat(r),e.dataset.status="".concat(t.status.current.name),e.dataset.statusText="".concat(t.status.current.label)}function addNewOptionToOrderSelector(t,e){var r,n,e=e.querySelector(".custom-select__list");e&&(e=e.querySelector('.custom-select__item:has([data-status="NEW_ORDER"])'))&&(r=window.formatDate(t.meta.created_at),n=e.querySelector("input").getAttribute("name"),n='\n\t\t<li class="custom-select__item custom-select__item--sort">\n\t\t\t<label class="custom-select__option"\n\t\t\t\t\tdata-order-id="'.concat(t.id,'"\n\t\t\t\t\tdata-article="').concat(t.number,'"\n\t\t\t\t\tdata-number1c="').concat(t.number_1c,'"\n\t\t\t\t\tdata-created="').concat(r,'"\n\t\t\t\t\tdata-status="').concat(t.status.current.name,'"\n\t\t\t\t\tdata-status-text="').concat(t.status.current.label,'">\n\t\t\t\t<input class="invisible" type="radio" name="').concat(n,'" checked>\n\t\t\t\t<span>',"Заказ № ".concat(t.number_1c||t.id," ").concat(t.number),"</span>\n\t\t\t\t<div>\n\t\t\t\t\t<i>от ").concat(r,"</i>\n\t\t\t\t\t<mark>").concat(t.status.current.label,"</mark>\n\t\t\t\t</div>\n\t\t\t</label>\n\t\t</li>\n\t"),e.insertAdjacentHTML("afterend",n))}window.addEventListener("load",function(){initProductCounters(),initCustomSelects(".custom-select, #fastView .custom-select"),getListOrders()});