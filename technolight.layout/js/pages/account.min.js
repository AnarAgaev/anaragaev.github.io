"use strict";function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(r,e){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var n,a,o,s,l=[],c=!0,i=!1;try{if(o=(t=t.call(r)).next,0===e){if(Object(t)!==t)return;c=!1}else for(;!(c=(n=o.call(t)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(r){i=!0,a=r}finally{try{if(!c&&null!=t.return&&(s=t.return(),Object(s)!==s))return}finally{if(i)throw a}}return l}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _createForOfIteratorHelper(r,e){var t,n,a,o,s="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(s)return n=!(t=!0),{s:function(){s=s.call(r)},n:function(){var r=s.next();return t=r.done,r},e:function(r){n=!0,a=r},f:function(){try{t||null==s.return||s.return()}finally{if(n)throw a}}};if(Array.isArray(r)||(s=_unsupportedIterableToArray(r))||e&&r&&"number"==typeof r.length)return s&&(r=s),o=0,{s:e=function(){},n:function(){return o>=r.length?{done:!0}:{done:!1,value:r[o++]}},e:function(r){throw r},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,e){var t;if(r)return"string"==typeof r?_arrayLikeToArray(r,e):"Map"===(t="Object"===(t=Object.prototype.toString.call(r).slice(8,-1))&&r.constructor?r.constructor.name:t)||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,e):void 0}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var initChangePassFormToggles=function(){var r=document.querySelectorAll("#changePasswordForm .account__form-toggle-pass");(r=Array.from(r)).forEach(function(r){return r.addEventListener("click",function(){var r=this.parentNode.querySelector("input");"text"===r.type?(r.type="password",this.classList.remove("pass-visible")):(r.type="text",this.classList.add("pass-visible"))})})},blockChangePassForm=function(){var r=document.querySelector("#changePasswordForm .account__form-button button");r.disabled=!0,setTimeout(function(){return r.disabled=!1},5e3)},changePasswordFormData={currentLength:!0,newLength:!0,isEqual:!0},resetAllErrorsPasswordForm=function(){var r=document.querySelectorAll("#changePasswordForm .account__form-controller");(r=Array.from(r)).forEach(function(r){return r.classList.remove("has-error")})},checkPassLength=function(r){return 8<=r.length},addInputPassHandler=function(r){r.addEventListener("input",function(){r.closest(".account__form-controller").classList.remove("has-error")})},checkChangePassForm=function(r,e){var t=changePasswordFormData.currentLength&&changePasswordFormData.newLength&&changePasswordFormData.isEqual,r=r.closest(".account__form-controller"),n=r.querySelector(".account__form-error"),e=e.closest(".account__form-controller"),a=e.querySelector(".account__form-error");return changePasswordFormData.currentLength||(n.innerText="Пароль должен содержать минимум 8 символов",r.classList.add("has-error")),changePasswordFormData.newLength?changePasswordFormData.isEqual||(a.innerText="Пароли должны совпадать",e.classList.add("has-error")):(a.innerText="Пароль должен содержать минимум 8 символов",e.classList.add("has-error")),changePasswordFormData.currentLength=!0,changePasswordFormData.newLength=!0,changePasswordFormData.isEqual=!0,t},initChangePasswordForm=function(){var e,t,r=document.querySelector("#changePasswordForm");r&&(e=r.querySelector("#currentPass"),t=r.querySelector("#newPass"),addInputPassHandler(e),addInputPassHandler(t),r.addEventListener("submit",function(r){r.preventDefault(),changePasswordFormData.currentLength=checkPassLength(e.value),changePasswordFormData.newLength=checkPassLength(t.value),changePasswordFormData.isEqual=e.value===t.value,checkChangePassForm(e,t)&&(resetAllErrorsPasswordForm(),console.log("Fetching request for updating user password"),window.showModalMsg("Изменение пароля","Пароль был успешно изменен"),blockChangePassForm())}))},setErrorOnUserDataController=function(r,e){var t=r.closest(".account__form-controller"),n=t.querySelector(".account__form-error");t.classList.add("has-error"),n.innerText=e,r.addEventListener("input",function(){t.classList.remove("has-error")})},resetErrorOnUserDataController=function(r){r.closest(".account__form-controller").classList.remove("has-error")},blockUserDataForm=function(){var r=document.querySelector("#changeUserDataForm .account__form-button button");r.disabled=!0,setTimeout(function(){return r.disabled=!1},5e3)},initChangeUserDataForm=function(){var c,r,i,u=document.getElementById("changeUserDataForm");u&&(c={name:!0,phone:!0,email:!0},r=u.querySelector('[name="phone"]'),i=IMask(r,{mask:"+{7} (000) 000-00-00",lazy:!0,placeholderChar:"#"}),r.addEventListener("focus",function(){return i.updateOptions({lazy:!1})}),r.addEventListener("blur",function(){return i.updateOptions({lazy:!0})}),u.addEventListener("submit",function(r){r.preventDefault();var r=this.querySelector('[name="name"]'),e=this.querySelector('[name="phone"]'),t=this.querySelector('[name="email"]');if(""===r.value?(setErrorOnUserDataController(r,"Заполните поле ФИО"),c.name=!1):(resetErrorOnUserDataController(r),c.name=!0),""===e.value?(setErrorOnUserDataController(e,"Заполните поле Телефон"),c.phone=!1):window.validatePhone(parseInt(i.unmaskedValue))?(resetErrorOnUserDataController(e),c.phone=!0):(setErrorOnUserDataController(e,"Некорректный номер телефона"),c.phone=!1),""===t.value||window.validateEmail(t.value)?(resetErrorOnUserDataController(t),c.email=!0):(setErrorOnUserDataController(t,"Некорректный адрес электронной почты"),c.email=!1),c.name&&c.phone&&c.email){var n,a=_createForOfIteratorHelper(new FormData(u));try{for(a.s();!(n=a.n()).done;){var o=_slicedToArray(n.value,2),s=o[0],l=o[1];console.log("".concat(s,": ").concat(l))}}catch(r){a.e(r)}finally{a.f()}console.log("Fetching request for updating user data"),window.showModalMsg("Личные данные","Личные данные изменены"),blockUserDataForm()}}))};window.addEventListener("load",function(){initChangePassFormToggles(),initChangePasswordForm(),initChangeUserDataForm()});