"use strict";var updateProductSum=function(t,e){var r=parseInt(t.value),t=t.closest(".cart__calc"),n=t.querySelector("[data-total]"),t=t.querySelector("[data-price]"),t=parseFloat(t.innerText.replace(/\s/g,"")),o=document.querySelector("#total"),a=parseFloat(o.innerText.replace(/\s/g,"")),e=e?a+t:a-t;n.innerText=formatNumber(t*r),o.innerText=formatNumber(Math.abs(e))},cartRequest=window.throttle(function(t,e){window.setProductToCart({art:t,count:e})},3e3),initCartCounter=function(){Array.from(document.querySelectorAll(".cart__calc-counter button")).forEach(function(t){t.addEventListener("click",function(){var t="inc"===this.dataset.type,e=this.parentNode.querySelector("input"),r=this.parentNode.querySelector('[data-type="dec"'),n=e.value,r=(0===(n=t?parseInt(n)+1:parseInt(n)-1)&&n++,r.disabled=!(1<n),e.value=n,updateProductSum(e,t),this.closest(".cart__item"));r&&(e=r.querySelector(".cart__title").innerText,cartRequest(e,n))})})},getTotalValue=function(){var t=document.getElementById("total").innerText;return parseInt(t.replace(/\s/g,""))},updateTotalPrice=function(t){document.getElementById("total").innerText=formatNumber(getTotalValue()+t)},checkTotalPrice=function(){var t=document.getElementById("total"),e=getTotalValue();console.log("totalNode",t),console.log("total",e),e<=0&&(t=document.querySelector(".cart__total"),e=document.querySelector(".cart__actions-btns .btn_dark"),t.style.justifyContent="center",t.innerHTML="<mark>В корзине нет товаров</mark>",e.remove())},delProduct=function(t){var e=t.offsetHeight;t.style.maxHeight=e+"px",setTimeout(function(){return t.classList.add("removed")},10),setTimeout(function(){return t.remove()},1e3),setTimeout(function(){showAnimElements(),setAnimationElms()},300)},initDelProdBtns=function(){Array.from(document.querySelectorAll(".cart__calc .btn_del")).forEach(function(r){return r.addEventListener("click",function(){var t=r.closest("[data-product]"),e=t.querySelector("[data-total]").innerText,e=parseInt(e.replace(/\s/g,"")),t=(delProduct(t),updateTotalPrice(-1*e),checkTotalPrice(),this.closest(".cart__item"));t&&(e=t.querySelector("input"),t=t.querySelector(".cart__title").innerText,window.removeProductFromCart({art:t,count:parseInt(e.value)}))})})};window.addEventListener("load",function(){initCartCounter(),initDelProdBtns()});